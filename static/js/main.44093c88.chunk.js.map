{"version":3,"sources":["config.ts","utils/ls.ts","components/ColorSchemeSwitcher.tsx","utils/rank.ts","components/Tooltip.tsx","components/Footer.tsx","pages/NotFound.tsx","data/languageList.ts","core/sparql.ts","utils/langNames.ts","utils/formatters.ts","utils/uniq.ts","core/escapeSparqlUrlSegment.ts","utils/withCache.ts","core/cognates.ts","components/Spinner.tsx","utils/qps.ts","utils/setupQps.ts","utils/pick.ts","dom/attachCustomValidityMessages.ts","utils/device.ts","hooks/useHtmlId.ts","components/LangSelect.tsx","components/SearchForm.tsx","utils/timing.ts","hooks/useValidationMessages.ts","core/seeAlsos.ts","core/translations.ts","core/fetchWiktionaryPage.ts","hooks/usePagination.ts","core/getWikiContent.ts","Routes.tsx","utils/browser.ts","dom/renderAsReactDom/mapDomToReact.tsx","dom/renderAsReactDom/index.tsx","dom/renderAsReactDom/parseStringToDom.ts","components/WiktionaryHtml.tsx","components/WiktionaryTitleLink.tsx","components/CognateLink.tsx","components/CognatesList.tsx","components/Pagination.tsx","components/CognatesTab.tsx","components/DefinitionTab.tsx","components/TabLink.tsx","components/Translations.tsx","components/TranslationsTab.tsx","components/Tabs.tsx","components/SearchHeader.tsx","components/ExampleLinks.tsx","pages/SearchResults.tsx","core/parseMobileSections.ts","pages/ShareTarget.tsx","components/GitHubCorner/index.tsx","components/RootErrorBoundary.tsx","App.tsx","utils/dynamicStyles.ts","serviceWorkerRegistration.ts","utils/viewportHeightAdjuster.ts","index.tsx","utils/addGlobalListeners.ts"],"names":["urls","etytreeNamespace","etytreeSparql","etytreeWeb","wiktionaryActionApi","wiktionaryRestApi","wiktionaryWeb","github","namespace","process","slice","ns","s","pseudoTarget","localStorage","ls","Proxy","get","_t","p","raw","getItem","JSON","parse","undefined","set","v","setItem","stringify","deleteProperty","removeItem","cognates","ancestor","langName","Object","keys","key","changeVariant","variant","document","documentElement","setAttribute","initialVariant","colorSchemeOverride","window","matchMedia","matches","shouldUseDarkVariant","Order","ColorSchemeSwitcher","useState","setVariant","useEffect","className","onClick","Tooltip","children","title","open","arrow","enterTouchDelay","htmlProps","componentsProps","tooltip","clsx","TransitionComponent","Fade","Footer","target","rel","href","buildInfo","ts","hash","NotFound","to","Path","Home","toRanker","rankFn","flow","Number","rank","order","rankFns","Array","isArray","x","Asc","rankers","map","a","b","ranker","result","endpoint","langCodesToNames","eng","zho","ita","fin","jpn","spa","fra","deu","pol","lat","por","rus","hbs","ron","nld","kor","enm","ces","hun","mkd","ara","ell","vie","swe","grc","cat","nno","nob","gle","glg","dan","hye","tha","hin","isl","epo","ceb","san","tur","tgl","ind","tel","kat","fas","bul","heb","lav","gla","ang","aze","ukr","sqi","tam","kaz","cym","glv","urd","fao","est","lit","syc","ido","ltz","fro","yid","mya","slk","ast","ady","nav","pli","mlt","non","asm","afr","sme","mon","oci","ben","zul","bak","ota","mlg","guj","sco","bel","sga","frm","got","bod","phl","eus","xho","dum","vec","haw","que","pdt","vep","vol","kmr","goh","nci","mal","mar","crh","tlh","cim","ajp","jbo","cop","fur","mnc","hau","osx","zha","scn","pdc","lao","qya","ary","hil","tpi","jav","nor","lld","chr","dsb","lad","tgk","bre","izh","kan","mah","uzb","cor","kum","mri","hrx","kas","sun","yol","nhn","aar","kik","lij","kea","tat","acw","srn","wln","grt","dlm","srd","yor","arn","chv","kbd","orm","nap","smj","odt","cic","mag","nds","chk","som","mnw","kyj","che","arg","uga","ckv","sux","amh","csb","lzz","ami","szl","krl","myv","lut","tuk","ipk","kld","egl","bam","unm","mga","okm","sah","tzm","nch","mrw","ewe","akk","tft","afb","urk","shn","cho","kpv","oss","tir","yog","cos","vro","hsb","smn","sms","vot","nhe","osp","arz","awg","alt","lkt","tet","ban","wol","bal","oge","ojp","chl","fij","mdf","lin","lmo","ofs","sje","kls","mch","nhg","kmk","apw","ist","inh","sna","orh","dak","ccc","olo","mak","sat","mwl","pjt","ase","smo","aot","axm","ckb","lud","iku","kjh","xag","cnk","extendedLangCodesToNames","langCodes","langNames","values","langNamesToCodes","fromEntries","entries","reverse","baseLang","getLangName","code","getExtendedLangName","underscorify","replace","capitalize","charAt","toUpperCase","wikify","encodeURIComponent","unwikify","decodeURIComponent","makeCognateFinderUrl","word","srcLang","trgLang_","trgLang","path","Definition","url","URL","location","origin","currentUrl","searchParams","getDefaultTrgLang","k","makeWiktionaryUrl","langCode","pathname","toRelativeUrl","absoluteUrl","addIfNotExists","val","alreadyExisted","has","add","uniq","getters","arr","length","push","getterFns","g","caches","Set","filter","reduce","getter","idx","pipe","disallowedAsciis","RegExp","from","_","i","String","fromCodePoint","codePointAt","acc","cur","last","y","toString","padStart","join","escapeForSparqlUrl","normalize","withCache","options","fn","defaults","keyGetter","cache","Map","maxSize","size","delete","next","value","sparqlClient","fetch","query","headers","res","ok","json","results","kind","status","text","error","toLangPathSegments","lang","getEtyTreePathname","etytreeUrl","toWordData","etytreePathname","split","_word","buildSparqlQuery","allowAffixes","depth","trgLangMatcher","uri","toEtyTreeUri","source","makeAncestor","level","branchId","makeWalker","varName","walkers","toAffixExcluderLine","affixExcluders","flatMap","sparql","fetchCognates","console","bindings","etymologies","binding","ancestor0","toAncestorVals","re","regex","toAncestorRegex","test","aAncestorVals","bAncestorVals","src","Boolean","trg","sort","Spinner","updateUrl","serialize","windowHistoryFn","method","search","history","pseudoHistory","createQps","init","defaultValue","pushState","setMany","updates","getMany","ks","getAll","defaultQpTypeOptions","omitIfDefault","applyOptions","queryOpts","opts","qpType","qpInit","page","shareText","initQps","getFormValues","qps","o","includes","attachCustomValidityMessages","messages","el","setValidity_","validity","valid","setCustomValidity","find","setValidity","listener","e","currentTarget","addEventListener","removeEventListener","isMobile","navigator","userAgent","clickInteraction","inc","generateHtmlId","prefix","LangSelect","id","setLangCode","enteredText","setEnteredText","listId","useHtmlId","type","list","placeholder","onChange","onFocus","onBlur","CognateSearchForm","onSubmit","form","seeAlsos","formRef","useRef","register","handleSubmit","watch","setValue","autocompleteOptions","setAutocompleteOptions","input","setInput","swap","useCallback","preventDefault","lastSubmittedAt","submit","now","Date","current","onKeyDown","controller","AbortController","signal","then","suggestions","catch","DOMException","name","abort","Promise","requestAnimationFrame","wordFormRef","ref","registerWord","wordValidationRef","dynamic","validationRef","m","_messages","cleanup","c","assign","useValidationMessages","valueMissing","htmlFor","required","onInput","autoCapitalize","autoFocus","option","parseSeeAlsos","match","wrap","allTranslationsRegex","translationLineRegex","individualTranslationRegex","toTranslationsObj","translations","kvs","line","groups","words","trData","isApiError","fetchFromApi","data","createSuccessResult","wikitext","fetchWiktionaryPageResult","msg","info","prefetchedVariants","variants","toLowerCase","variantData","r","Error","defaultOptions","pageSize","startPage","partsOfSpeech","fetchWordSections","sections","remaining","getDefinitionDomForLanguage","language","word_","start","findIndex","toclevel","_end","end","trim","doc","DOMParser","parseFromString","base","createElement","head","appendChild","body","querySelectorAll","remove","link","rawHref","getAttribute","originalUrl","rawWord","parsedWord","srcLangName","srcLangCode","isHashOnlyLink","startsWith","querySelector","lastSubmitted","definition","fetchWiktionaryDefinitionHtml","outerHTML","isSameOrigin","allowedAttrs","allowedPrefixes","reactProps","class","mapDomToReact","parseCustomNode","mapDomToReact_","node","nodeType","Node","TEXT_NODE","isTextNode","ELEMENT_NODE","isHtmlElementNode","customNode","style","attr","El","nodeName","props","attributes","some","bind","p1","p2","warn","textContent","childNodes","n","innerHTML","dangerouslySetInnerHTML","__html","renderAsReactDom","parser","mapper","str","dom","parseStringToDom","createWiktionaryHtmlRenderer","render","dangerousHtml","WiktionaryHtml","WiktionaryHtmlRootLevel","HTMLAnchorElement","WiktionaryTitleLink","wiktionaryUrl","CognateLink","referenceElement","setReferenceElement","popperElement","setPopperElement","usePopper","placement","strategy","modifiers","rootBoundary","mainAxis","flipVariations","padding","allowedAutoPlacements","styles","forceUpdate","popoverHtml","setPopoverHtml","useHistory","cognateFinderUrl","useMemo","makeWiktionarySearchUrl","setOpen","loading","setLoading","extendedLangName","showPopover","html","hidePopover","reactHoverEventNames","htmlHoverEventNames","onEvents","hidePopoverIfNotCurrentTarget","contains","offEvents","suppressOnEsc","forEach","isLink","popper","CognatesList","pageStart","pageEnd","Pagination","maxPageNo","setPage","CognatesTab","useContext","QpsContext","pagination","items","Math","ceil","incrementPage","min","decrementPage","max","usePagination","hydrated","updatePage","message","DefinitionTab","suggestedLangPairs","suggestTryFlipped","otherSuggestions","TabLink","forwardRef","exact","disabled","disabledMessage","activeClassName","Translations","meaning","TranslationsTab","Tabs","useLocation","cognatesTooltipDismissed","Cognates","translate","LinkOrText","isHome","SearchHeader","toExample","examples","flat","ExampleLinks","xs","random","SearchResults","setSeeAlsos","setTranslations","defaultValues","useForm","reset","setQuery","setError","setCognates","setLastSubmitted","setDefinition","setSuggestedLangPairs","canceled","every","all","wiktionaryResult","wiktionaryText","matchAll","langCodesFromSections","getLangCodesFromSections","u","relevantTranslations","checkIsHome","ShareTarget","content","createContext","Routes","Provider","GitHubCorner","octoBannerProps","octoArmProps","octoBodyProps","rtl","linkProps","rtlStyles","right","left","transform","width","height","viewBox","d","RootErrorBoundary","state","hasError","errorInfo","this","clear","Component","App","basename","cssConstants","ROOT_URL","matcher","isLocalhost","hostname","registerValidSW","swUrl","config","serviceWorker","registration","onupdatefound","installingWorker","installing","onstatechange","onUpdate","onSuccess","setVh","vh","innerHeight","setProperty","styleSheets","sheet","cssRules","rule","CSSStyleRule","selectorText","injectCssConstants","scrollTo","getElementById","response","contentType","indexOf","ready","unregister","reload","checkValidServiceWorker","serviceWorkerRegistration"],"mappings":"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","file":"static/js/main.44093c88.chunk.js","sourcesContent":["export const urls = {\n\tetytreeNamespace: 'http://etytree-virtuoso.wmflabs.org/dbnary',\n\tetytreeSparql: 'https://etytree-virtuoso.wmflabs.org/sparql',\n\tetytreeWeb: 'https://etytree.toolforge.org',\n\n\twiktionaryActionApi: 'https://en.wiktionary.org/w/api.php?origin=*',\n\twiktionaryRestApi: 'https://en.wiktionary.org/api',\n\twiktionaryWeb: 'https://en.wiktionary.org',\n\n\tgithub: 'https://github.com/lionel-rowe/cognado',\n} as const\n","import type { FormValues } from '../utils/setupQps'\nimport type { CognateRaw } from '../core/cognates'\nimport type { Translations } from '../core/translations'\nimport type { Variant } from '../components/ColorSchemeSwitcher'\nimport { LangCode } from './langNames'\n\nexport type LangPair = {\n\tsrcLang: LangCode\n\ttrgLang: LangCode\n}\n\nconst namespace = process.env.PUBLIC_URL.slice(1)\nconst ns = (s: string) => (namespace ? `${namespace}::${s}` : s)\n\nconst pseudoTarget = localStorage as Partial<{\n\tlastSubmitted: FormValues\n\tcognates: CognateRaw[]\n\tquery: string\n\twiktionaryUrl: string | null\n\tseeAlsos: string[]\n\ttranslations: Translations\n\tsuggestedLangPairs: LangPair[]\n\tcolorSchemeOverride: Variant\n\tcognatesTooltipDismissed: boolean\n\tdefinition: string\n}>\n\nexport const ls = new Proxy(pseudoTarget, {\n\tget(_t, p: string) {\n\t\tconst raw = localStorage.getItem(ns(p))\n\n\t\ttry {\n\t\t\treturn raw ? JSON.parse(raw) : undefined\n\t\t} catch {\n\t\t\treturn undefined\n\t\t}\n\t},\n\tset(_t, p: string, v) {\n\t\ttry {\n\t\t\tlocalStorage.setItem(ns(p), JSON.stringify(v))\n\n\t\t\treturn true\n\t\t} catch {\n\t\t\treturn false\n\t\t}\n\t},\n\tdeleteProperty(_t, p: string) {\n\t\tlocalStorage.removeItem(ns(p))\n\n\t\treturn true\n\t},\n})\n\nif ((ls.cognates?.[0]?.ancestor as any)?.langName) {\n\t// incompatible data format\n\n\tfor (const key of Object.keys(pseudoTarget)) {\n\t\tdelete ls[key as keyof typeof pseudoTarget]\n\t}\n}\n","import { useState, useEffect, FC } from 'react'\nimport { ls } from '../utils/ls'\n\nexport type Variant = 'dark' | 'light'\n\nconst changeVariant = (variant: Variant) => {\n\tdocument.documentElement.setAttribute('class', variant)\n}\n\nconst shouldUseDarkVariant = () => {\n\treturn ls.colorSchemeOverride\n\t\t? ls.colorSchemeOverride === 'dark'\n\t\t: window.matchMedia?.('(prefers-color-scheme: dark)').matches\n}\n\nconst initialVariant: Variant = shouldUseDarkVariant() ? 'dark' : 'light'\n\nchangeVariant(initialVariant)\n\nexport const ColorSchemeSwitcher: FC = () => {\n\tconst [variant, setVariant] = useState<Variant>(initialVariant)\n\n\tuseEffect(() => {\n\t\tls.colorSchemeOverride = variant\n\n\t\tchangeVariant(variant)\n\t}, [variant])\n\n\treturn (\n\t\t<span className='color-scheme-switcher-container'>\n\t\t\t<button\n\t\t\t\tonClick={() =>\n\t\t\t\t\tsetVariant((v) => (v === 'dark' ? 'light' : 'dark'))\n\t\t\t\t}\n\t\t\t\tclassName='color-scheme-switcher'\n\t\t\t\taria-label='Switch color scheme'\n\t\t\t>\n\t\t\t\t{variant === 'dark' ? '🌛' : '🌞'}\n\t\t\t</button>\n\t\t</span>\n\t)\n}\n","import { flow } from 'fp-ts/lib/function'\n\ntype Getter<T, R extends unknown = unknown> = (x: T) => R\n\nexport enum Order {\n\tAsc = 1,\n\tDesc = -1,\n}\nconst toRanker = <T>(rankFn: Getter<T>) => flow(rankFn, Number)\n\nexport function rank<T>(\n\trankFn?: Getter<T> | Getter<T>[],\n\torder?: Order,\n): (a: T, b: T) => number {\n\tconst rankFns = !rankFn\n\t\t? [(x: T) => x]\n\t\t: Array.isArray(rankFn)\n\t\t? rankFn\n\t\t: [rankFn]\n\n\torder ??= Order.Asc\n\n\tconst rankers = rankFns.map(toRanker)\n\n\treturn (a: T, b: T) => {\n\t\tfor (const ranker of rankers) {\n\t\t\tconst result = ranker(a) - ranker(b)\n\n\t\t\tif (result) {\n\t\t\t\treturn order! * result\n\t\t\t}\n\t\t}\n\n\t\treturn 0\n\t}\n}\n","import { FC, HTMLProps, ReactElement } from 'react'\nimport { Tooltip as MuiTooltip } from '@mui/material'\nimport clsx from 'clsx'\nimport Fade from '@mui/material/Fade'\n\nexport type ReactEventName = `on${Capitalize<string>}` &\n\tkeyof React.DOMAttributes<HTMLAnchorElement>\n\ntype Props = {\n\tchildren: ReactElement<any, any>\n\topen?: boolean\n\tarrow?: boolean\n\tenterTouchDelay?: number\n} & Pick<HTMLProps<HTMLElement>, 'title' | 'className' | 'id' | ReactEventName>\n\nexport const Tooltip: FC<Props> = ({\n\tchildren,\n\ttitle,\n\tclassName,\n\topen,\n\tarrow,\n\tenterTouchDelay,\n\t...htmlProps\n}) => {\n\treturn (\n\t\t<MuiTooltip\n\t\t\tcomponentsProps={{\n\t\t\t\ttooltip: {\n\t\t\t\t\tclassName: clsx([\n\t\t\t\t\t\t'tooltip',\n\t\t\t\t\t\tarrow && 'tooltip--has-arrow',\n\t\t\t\t\t\tclassName,\n\t\t\t\t\t]),\n\t\t\t\t},\n\t\t\t\tarrow: { className: 'tooltip__arrow' },\n\t\t\t}}\n\t\t\t// must use `Fade` or no transition, otherwise\n\t\t\t// doesn't play nicely with CSS hack to fix blurring\n\t\t\tTransitionComponent={Fade}\n\t\t\ttitle={title ?? ''}\n\t\t\tenterTouchDelay={enterTouchDelay ?? 0}\n\t\t\t{...{ arrow, open }}\n\t\t\t{...htmlProps}\n\t\t>\n\t\t\t{children}\n\t\t</MuiTooltip>\n\t)\n}\n","import { FC, HtmlHTMLAttributes } from 'react'\nimport { urls } from '../config'\nimport buildInfo from '../buildInfo.json'\nimport { ColorSchemeSwitcher } from './ColorSchemeSwitcher'\nimport { Tooltip } from './Tooltip'\n\nexport const Footer: FC<HtmlHTMLAttributes<HTMLElement>> = ({\n\t...htmlProps\n}) => {\n\t// just redirect for now\n\n\treturn (\n\t\t<footer {...htmlProps}>\n\t\t\t<hr />\n\t\t\t<div className='footer-text'>\n\t\t\t\t<small>\n\t\t\t\t\tData from{' '}\n\t\t\t\t\t<a\n\t\t\t\t\t\ttarget='_blank'\n\t\t\t\t\t\trel='noreferrer noopener'\n\t\t\t\t\t\thref={urls.wiktionaryWeb}\n\t\t\t\t\t>\n\t\t\t\t\t\tWiktionary\n\t\t\t\t\t</a>{' '}\n\t\t\t\t\t(\n\t\t\t\t\t<a\n\t\t\t\t\t\ttarget='_blank'\n\t\t\t\t\t\trel='noreferrer noopener'\n\t\t\t\t\t\thref='https://creativecommons.org/licenses/by-sa/3.0/'\n\t\t\t\t\t>\n\t\t\t\t\t\tCC BY-SA 3.0\n\t\t\t\t\t</a>\n\t\t\t\t\t) · Etymology search powered by{' '}\n\t\t\t\t\t<a\n\t\t\t\t\t\ttarget='_blank'\n\t\t\t\t\t\trel='noreferrer noopener'\n\t\t\t\t\t\thref={urls.etytreeWeb}\n\t\t\t\t\t>\n\t\t\t\t\t\tetytree\n\t\t\t\t\t</a>{' '}\n\t\t\t\t\t(\n\t\t\t\t\t<a\n\t\t\t\t\t\ttarget='_blank'\n\t\t\t\t\t\trel='noreferrer noopener'\n\t\t\t\t\t\thref='https://opensource.org/licenses/MIT'\n\t\t\t\t\t>\n\t\t\t\t\t\tMIT\n\t\t\t\t\t</a>\n\t\t\t\t\t) · Version{' '}\n\t\t\t\t\t<Tooltip title={buildInfo.ts}>\n\t\t\t\t\t\t<code className='build-info'>{buildInfo.hash}</code>\n\t\t\t\t\t</Tooltip>\n\t\t\t\t\t<ColorSchemeSwitcher />\n\t\t\t\t</small>\n\t\t\t</div>\n\t\t</footer>\n\t)\n}\n","import { Link } from 'react-router-dom'\nimport { Path } from '../Routes'\n\nexport const NotFound = () => {\n\treturn (\n\t\t<>\n\t\t\t<h1>Page Not Found</h1>\n\n\t\t\t<p>\n\t\t\t\t<Link to={Path.Home}>Home</Link>\n\t\t\t</p>\n\t\t</>\n\t)\n}\n","/**\n\n# Extended language list scraped as follows:\n\nhttps://en.wiktionary.org/wiki/Wiktionary:List_of_languages\n\n```js\nJSON.stringify(\n\tObject.fromEntries(\n\t\t[...document.querySelectorAll('table tbody')]\n\t\t\t.flatMap(tbody => [...tbody.querySelectorAll('tr')]\n\t\t\t\t.map(x => [...x.querySelectorAll('td')].map(x => x.textContent.trim()))\n\t\t\t\t.map(([code, canonicalName]) => ({ code, canonicalName })\n\n\t\t\t\t).filter(({ code }) => code?.length > 2)\n\t\t\t).map(({ code, canonicalName }) => [code, canonicalName])\n\t)\n)\n```\n\n---\n\n# Basic language list scraped as follows:\n\n## Step 1 - Wiktionary frequent languages\n\nhttps://en.wiktionary.org/wiki/Wiktionary:Statistics\n\n```js\nconst rows = [...document.querySelector('tbody').querySelectorAll('tr')]\n\nconst x = rows\n\t.map((row) =>\n\t\t[...row.querySelectorAll('td')]\n\t\t\t.slice(0, 2)\n\t\t\t.map((x) => x.textContent.replace(/\\(.*\\d.*\\)\\s*$/, '').trim()),\n\t)\n\t.map(([lang, num]) => ({ lang, num: +num }))\n\t.sort((a, b) => b.num - a.num)\n\t.map((x) => x.lang)\n\t.slice(0, 350)\n\nJSON.stringify(x)\n```\n\n## Step 2 - EtyTree source for ISO 639-3 codes\n\nhttps://raw.githubusercontent.com/esterpantaleo/etymology/ad2062ee3714ab0845d00388b29a052ad26021c8/resources/data/iso-639-3.tab\n\n```js\nconst frequentLangs = [[[PASTE FROM ABOVE RESULTS]]]\n\nconst _langNames = document\n\t.querySelector('pre')\n\t.textContent.split('\\n')\n\t.filter((x) => x.trim())\n\t.map((x) => x.split('\\t'))\n\t.map((x) => {\n\t\tconst codes = x.slice(0, 1).filter((x) => x.trim())\n\t\tconst name = x[6]\n\n\t\treturn { codes, name }\n\t})\n\t.reduce((acc, { codes, name }) => {\n\t\tfor (const code of codes) {\n\t\t\tacc[code] = name.replace(/\\(.*\\d.*\\)$/, '').trim()\n\t\t}\n\n\t\treturn acc\n\t}, Object.create(null))\n\nconst overrides = {\n\tell: 'Greek', // not \"Modern Greek\"\n}\n\nconst langNames = Object.assign(\n\tObject.fromEntries(\n\t\tObject.entries(_langNames).sort(([kA, a], [kB, b]) =>\n\t\t\tkA === 'eng'\n\t\t\t\t? -Infinity\n\t\t\t\t: kB === 'eng'\n\t\t\t\t? Infinity\n\t\t\t\t: a.localeCompare(b),\n\t\t),\n\t),\n\toverrides,\n)\n\nlangNames.ell = 'Greek' // hard code - not \"Modern Greek\"\n\nconst langNamesReverse = Object.fromEntries(\n\tObject.entries(langNames).map((x) => x.reverse()),\n)\n\nObject.fromEntries(\n\tfrequentLangs\n\t\t.map((lang) => [langNamesReverse[lang], lang])\n\t\t.filter(([x]) => x),\n)\n```\n\n*/\n\nexport const langCodesToNames = {\n\teng: 'English',\n\tzho: 'Chinese',\n\tita: 'Italian',\n\tfin: 'Finnish',\n\tjpn: 'Japanese',\n\tspa: 'Spanish',\n\tfra: 'French',\n\tdeu: 'German',\n\tpol: 'Polish',\n\tlat: 'Latin',\n\tpor: 'Portuguese',\n\trus: 'Russian',\n\thbs: 'Serbo-Croatian',\n\tron: 'Romanian',\n\tnld: 'Dutch',\n\tkor: 'Korean',\n\tenm: 'Middle English',\n\tces: 'Czech',\n\thun: 'Hungarian',\n\tmkd: 'Macedonian',\n\tara: 'Arabic',\n\tell: 'Greek',\n\tvie: 'Vietnamese',\n\tswe: 'Swedish',\n\tgrc: 'Ancient Greek',\n\tcat: 'Catalan',\n\tnno: 'Norwegian Nynorsk',\n\tnob: 'Norwegian Bokmål',\n\tgle: 'Irish',\n\tglg: 'Galician',\n\tdan: 'Danish',\n\thye: 'Armenian',\n\ttha: 'Thai',\n\thin: 'Hindi',\n\tisl: 'Icelandic',\n\tepo: 'Esperanto',\n\tceb: 'Cebuano',\n\tsan: 'Sanskrit',\n\ttur: 'Turkish',\n\ttgl: 'Tagalog',\n\tind: 'Indonesian',\n\ttel: 'Telugu',\n\tkat: 'Georgian',\n\tfas: 'Persian',\n\tbul: 'Bulgarian',\n\theb: 'Hebrew',\n\tlav: 'Latvian',\n\tgla: 'Scottish Gaelic',\n\tang: 'Old English',\n\taze: 'Azerbaijani',\n\tukr: 'Ukrainian',\n\tsqi: 'Albanian',\n\ttam: 'Tamil',\n\tkaz: 'Kazakh',\n\tcym: 'Welsh',\n\tglv: 'Manx',\n\turd: 'Urdu',\n\tfao: 'Faroese',\n\test: 'Estonian',\n\tlit: 'Lithuanian',\n\tsyc: 'Classical Syriac',\n\tido: 'Ido',\n\tltz: 'Luxembourgish',\n\tfro: 'Old French',\n\tyid: 'Yiddish',\n\tmya: 'Burmese',\n\tslk: 'Slovak',\n\tast: 'Asturian',\n\tady: 'Adyghe',\n\tnav: 'Navajo',\n\tpli: 'Pali',\n\tmlt: 'Maltese',\n\tnon: 'Old Norse',\n\tasm: 'Assamese',\n\tafr: 'Afrikaans',\n\tsme: 'Northern Sami',\n\tmon: 'Mongolian',\n\toci: 'Occitan',\n\tben: 'Bengali',\n\tzul: 'Zulu',\n\tbak: 'Bashkir',\n\tota: 'Ottoman Turkish',\n\tmlg: 'Malagasy',\n\tguj: 'Gujarati',\n\tsco: 'Scots',\n\tbel: 'Belarusian',\n\tsga: 'Old Irish',\n\tfrm: 'Middle French',\n\tgot: 'Gothic',\n\tbod: 'Tibetan',\n\tphl: 'Phalura',\n\teus: 'Basque',\n\txho: 'Xhosa',\n\tdum: 'Middle Dutch',\n\tvec: 'Venetian',\n\thaw: 'Hawaiian',\n\tque: 'Quechua',\n\tpdt: 'Plautdietsch',\n\tvep: 'Veps',\n\tvol: 'Volapük',\n\tkmr: 'Northern Kurdish',\n\tgoh: 'Old High German',\n\tnci: 'Classical Nahuatl',\n\tmal: 'Malayalam',\n\tmar: 'Marathi',\n\tcrh: 'Crimean Tatar',\n\ttlh: 'Klingon',\n\tcim: 'Cimbrian',\n\tajp: 'South Levantine Arabic',\n\tjbo: 'Lojban',\n\tcop: 'Coptic',\n\tfur: 'Friulian',\n\tmnc: 'Manchu',\n\thau: 'Hausa',\n\tosx: 'Old Saxon',\n\tzha: 'Zhuang',\n\tscn: 'Sicilian',\n\tpdc: 'Pennsylvania German',\n\tlao: 'Lao',\n\tqya: 'Quenya',\n\tary: 'Moroccan Arabic',\n\thil: 'Hiligaynon',\n\ttpi: 'Tok Pisin',\n\tjav: 'Javanese',\n\tnor: 'Norwegian',\n\tlld: 'Ladin',\n\tchr: 'Cherokee',\n\tdsb: 'Lower Sorbian',\n\tlad: 'Ladino',\n\ttgk: 'Tajik',\n\tbre: 'Breton',\n\tizh: 'Ingrian',\n\tkan: 'Kannada',\n\tmah: 'Marshallese',\n\tuzb: 'Uzbek',\n\tcor: 'Cornish',\n\tkum: 'Kumyk',\n\tmri: 'Maori',\n\thrx: 'Hunsrik',\n\tkas: 'Kashmiri',\n\tsun: 'Sundanese',\n\tyol: 'Yola',\n\tnhn: 'Central Nahuatl',\n\taar: 'Afar',\n\tkik: 'Kikuyu',\n\tlij: 'Ligurian',\n\tkea: 'Kabuverdianu',\n\ttat: 'Tatar',\n\tacw: 'Hijazi Arabic',\n\tsrn: 'Sranan Tongo',\n\twln: 'Walloon',\n\tgrt: 'Garo',\n\tdlm: 'Dalmatian',\n\tsrd: 'Sardinian',\n\tyor: 'Yoruba',\n\tarn: 'Mapudungun',\n\tchv: 'Chuvash',\n\tkbd: 'Kabardian',\n\torm: 'Oromo',\n\tnap: 'Neapolitan',\n\tsmj: 'Lule Sami',\n\todt: 'Old Dutch',\n\tcic: 'Chickasaw',\n\tmag: 'Magahi',\n\tnds: 'Low German',\n\tchk: 'Chuukese',\n\tsom: 'Somali',\n\tmnw: 'Mon',\n\tkyj: 'Karao',\n\tche: 'Chechen',\n\targ: 'Aragonese',\n\tuga: 'Ugaritic',\n\tckv: 'Kavalan',\n\tsux: 'Sumerian',\n\tamh: 'Amharic',\n\tcsb: 'Kashubian',\n\tlzz: 'Laz',\n\tami: 'Amis',\n\tszl: 'Silesian',\n\tkrl: 'Karelian',\n\tmyv: 'Erzya',\n\tlut: 'Lushootseed',\n\ttuk: 'Turkmen',\n\tipk: 'Inupiaq',\n\tkld: 'Gamilaraay',\n\tegl: 'Emilian',\n\tbam: 'Bambara',\n\tunm: 'Unami',\n\tmga: 'Middle Irish',\n\tokm: 'Middle Korean',\n\tsah: 'Yakut',\n\ttzm: 'Central Atlas Tamazight',\n\tnch: 'Central Huasteca Nahuatl',\n\tmrw: 'Maranao',\n\tewe: 'Ewe',\n\takk: 'Akkadian',\n\ttft: 'Ternate',\n\tafb: 'Gulf Arabic',\n\turk: \"Urak Lawoi'\",\n\tshn: 'Shan',\n\tcho: 'Choctaw',\n\tkpv: 'Komi-Zyrian',\n\toss: 'Ossetian',\n\ttir: 'Tigrinya',\n\tyog: 'Yogad',\n\tcos: 'Corsican',\n\tvro: 'Võro',\n\thsb: 'Upper Sorbian',\n\tsmn: 'Inari Sami',\n\tsms: 'Skolt Sami',\n\tvot: 'Votic',\n\tnhe: 'Eastern Huasteca Nahuatl',\n\tosp: 'Old Spanish',\n\tarz: 'Egyptian Arabic',\n\tawg: 'Anguthimri',\n\talt: 'Southern Altai',\n\tlkt: 'Lakota',\n\ttet: 'Tetum',\n\tban: 'Balinese',\n\twol: 'Wolof',\n\tbal: 'Baluchi',\n\toge: 'Old Georgian',\n\tojp: 'Old Japanese',\n\tchl: 'Cahuilla',\n\tfij: 'Fijian',\n\tmdf: 'Moksha',\n\tlin: 'Lingala',\n\tlmo: 'Lombard',\n\tofs: 'Old Frisian',\n\tsje: 'Pite Sami',\n\tkls: 'Kalasha',\n\tmch: 'Maquiritari',\n\tnhg: 'Tetelcingo Nahuatl',\n\tkmk: 'Limos Kalinga',\n\tapw: 'Western Apache',\n\tist: 'Istriot',\n\tinh: 'Ingush',\n\tsna: 'Shona',\n\torh: 'Oroqen',\n\tdak: 'Dakota',\n\tccc: 'Chamicuro',\n\tolo: 'Livvi',\n\tmak: 'Makasar',\n\tsat: 'Santali',\n\tmwl: 'Mirandese',\n\tpjt: 'Pitjantjatjara',\n\tase: 'American Sign Language',\n\tsmo: 'Samoan',\n\taot: 'Atong (India)',\n\taxm: 'Middle Armenian',\n\tckb: 'Central Kurdish',\n\tlud: 'Ludian',\n\tiku: 'Inuktitut',\n\tkjh: 'Khakas',\n\txag: 'Aghwan',\n\tcnk: 'Khumi Chin',\n} as const\n","import { urls } from '../config'\nimport { withCache } from '../utils/withCache'\n\nexport type Branch = 'a' | 'b'\n\nexport const ancestor = 'ancestor'\nexport type Ancestor = typeof ancestor\n\nexport type SuccessResult = {\n\tkind: 'success'\n\tresults: {\n\t\tbindings: Record<\n\t\t\t'target' | `${Ancestor}0` | `${Ancestor}${number}${Branch}`,\n\t\t\t{ type: 'uri'; value: string }\n\t\t>[]\n\t}\n}\n\nexport type ErrorResult = {\n\tkind: 'error'\n\tstatus: number\n\terror: string\n}\n\ntype Result = ErrorResult | SuccessResult\n\nexport const createSparqlClient = (endpoint: string) => {\n\treturn {\n\t\tfetch: withCache(null, async (query: string): Promise<Result> => {\n\t\t\tconst url = new URL(endpoint)\n\n\t\t\turl.searchParams.set('query', query)\n\n\t\t\tconst headers = [['Accept', 'application/sparql-results+json']]\n\n\t\t\tconst res = await fetch(url.href, { headers })\n\n\t\t\tconst result: Result = res.ok\n\t\t\t\t? { kind: 'success', results: (await res.json()).results }\n\t\t\t\t: {\n\t\t\t\t\t\tkind: 'error',\n\t\t\t\t\t\tstatus: res.status,\n\t\t\t\t\t\terror: await res.text(),\n\t\t\t\t  }\n\n\t\t\treturn result\n\t\t}),\n\t}\n}\n\nexport const sparqlClient = createSparqlClient(urls.etytreeSparql)\n","import { langCodesToNames } from '../data/languageList'\nimport extendedLangCodesToNames_ from '../data/extendedLanguageList.json'\n\nconst extendedLangCodesToNames = extendedLangCodesToNames_ as Record<\n\tstring,\n\tstring\n>\n\nexport type LangCodesToNames = typeof langCodesToNames\n\nexport { langCodesToNames }\n\nexport type LangCode = keyof LangCodesToNames\nexport const langCodes = Object.keys(langCodesToNames) as LangCode[]\n\nexport type LangName = LangCodesToNames[LangCode]\nexport const langNames = Object.values(langCodesToNames) as LangName[]\n\nexport const langNamesToCodes = Object.fromEntries(\n\tObject.entries(langCodesToNames).map((x) => x.reverse()),\n) as {\n\t[key in LangCodesToNames[keyof LangCodesToNames]]: LangCode\n}\n\nexport const baseLang: LangCode = 'eng'\n\nexport const getLangName = (code: string): string => {\n\treturn langCodesToNames[code as LangCode] ?? code\n}\n\nexport const getExtendedLangName = (code: string): string => {\n\treturn (\n\t\tlangCodesToNames[code as LangCode] ??\n\t\textendedLangCodesToNames[code as LangCode] ??\n\t\tcode\n\t)\n}\n","import { flow } from 'fp-ts/lib/function'\nimport { urls } from '../config'\nimport { Path } from '../Routes'\nimport { getLangName, LangCode } from './langNames'\n\nexport const underscorify = (x: string) => x.replace(/ /g, '_')\n\nexport const capitalize = (x: string) => x.charAt(0).toUpperCase() + x.slice(1)\n\nexport const forceCapitalize = (x: string) =>\n\tx.charAt(0).toUpperCase() + x.slice(1).toLowerCase()\n\nexport const kebabToCamel = (kebab: string) =>\n\tkebab.replace(/([a-z])-([a-z])/g, (_, p1, p2) => p1 + p2.toUpperCase())\n\nexport const wikify = flow(underscorify, encodeURIComponent)\nexport const unwikify = flow(decodeURIComponent, (x) => x.replace(/_/g, ' '))\n\nexport const getDefaultTrgLang = (srcLang: LangCode): LangCode => {\n\tconst currentUrl = new URL(window.location.href)\n\n\treturn (\n\t\t(currentUrl.searchParams.get(\n\t\t\tcurrentUrl.searchParams.get('trgLang') === srcLang\n\t\t\t\t? 'srcLang'\n\t\t\t\t: 'trgLang',\n\t\t) as LangCode) ?? 'eng'\n\t)\n}\n\nexport const makeCognateFinderUrl = ({\n\tword,\n\tsrcLang,\n\ttrgLang: trgLang_,\n\tpath = Path.Definition,\n}: {\n\tword: string\n\tsrcLang: LangCode\n\ttrgLang?: LangCode\n\tpath?: Path\n}) => {\n\tconst url = new URL(process.env.PUBLIC_URL + path, window.location.origin)\n\n\tconst trgLang = trgLang_ ?? getDefaultTrgLang(srcLang)\n\n\tfor (const [k, v] of Object.entries({\n\t\tword,\n\t\tsrcLang,\n\t\ttrgLang,\n\t})) {\n\t\turl.searchParams.set(k, v)\n\t}\n\n\treturn url.href\n}\n\nexport const makeWiktionaryUrl = ({\n\tword,\n\tlangCode,\n}: {\n\tword: string\n\tlangCode: LangCode\n}) => {\n\tconst url = new URL(urls.wiktionaryWeb)\n\turl.pathname = `/wiki/${wikify(word)}`\n\turl.hash = wikify(getLangName(langCode))\n\n\treturn url.href\n}\n\nexport const makeWiktionarySearchUrl = ({ word }: { word: string }) => {\n\tconst url = new URL('/w/index.php', urls.wiktionaryWeb)\n\n\turl.searchParams.set('search', word)\n\n\treturn url.href\n}\n\nexport const toRelativeUrl = (absoluteUrl: string) =>\n\tabsoluteUrl.replace(\n\t\t`${window.location.origin}${process.env.PUBLIC_URL}`,\n\t\t'',\n\t)\n","import { pipe } from 'fp-ts/lib/function'\n\nconst addIfNotExists =\n\t<T>(val: T) =>\n\t(set: Set<T>) => {\n\t\tconst alreadyExisted = set.has(val)\n\n\t\tif (!alreadyExisted) set.add(val)\n\n\t\treturn !alreadyExisted\n\t}\n\nexport const uniq =\n\t<T>(...getters: (keyof T | ((x: T) => any))[]) =>\n\t(arr: T[]) => {\n\t\tif (!getters.length) getters.push((x) => x)\n\n\t\tconst getterFns = getters.map((g) =>\n\t\t\ttypeof g === 'string' ? (x: T) => x[g] : g,\n\t\t) as ((x: T) => any)[]\n\n\t\tconst caches = getterFns.map(() => new Set<T>())\n\n\t\treturn arr.filter((x) =>\n\t\t\tgetterFns.reduce(\n\t\t\t\t(val, getter, idx) =>\n\t\t\t\t\tpipe(caches[idx], addIfNotExists(getter(x))) || val,\n\t\t\t\tfalse as boolean,\n\t\t\t),\n\t\t)\n\t}\n","import { flow } from 'fp-ts/lib/function'\nimport { underscorify } from '../utils/formatters'\n\nconst disallowedAsciis = new RegExp(\n\t'[' +\n\t\tArray.from({ length: 0x80 }, (_, i) => String.fromCodePoint(i))\n\t\t\t.filter((x) => encodeURIComponent(x) !== x)\n\t\t\t.map((x) => x.codePointAt(0) ?? 0)\n\t\t\t.reduce((acc, cur) => {\n\t\t\t\tconst last = acc[acc.length - 1]\n\n\t\t\t\tif (!last || cur > last[last.length - 1] + 1) {\n\t\t\t\t\tacc.push([cur])\n\t\t\t\t} else {\n\t\t\t\t\tlast[1] = cur\n\t\t\t\t}\n\n\t\t\t\treturn acc\n\t\t\t}, [] as ([number] | [number, number])[])\n\t\t\t.map((x) =>\n\t\t\t\tx.map((y) => '\\\\x' + y.toString(16).padStart(2, '0')).join('-'),\n\t\t\t)\n\t\t\t.join('') +\n\t\t']',\n\t'g',\n)\n\n// TODO - properly escape rather than just strip\n// - how does SPARQL want them escaped? O_o\nexport const escapeForSparqlUrl = flow(\n\tunderscorify,\n\t(x) => x.replace(disallowedAsciis, ''),\n\t(x) => x.normalize('NFC'),\n)\n","type Options<Args extends any[], Res> = {\n\tkeyGetter: (...args: Args) => string\n\tcache: Map<string, Res>\n\tmaxSize: number\n}\n\nexport const withCache = <Args extends any[], Res>(\n\toptions: Args extends [string]\n\t\t? Partial<Options<Args, Res>> | null\n\t\t: Partial<Options<Args, Res>> & Pick<Options<Args, Res>, 'keyGetter'>,\n\tfn: (...args: Args) => Promise<Res>,\n): ((...args: Args) => Promise<Res>) => {\n\tconst defaults: Options<[string], any> = {\n\t\tkeyGetter: (word: string) => word,\n\t\tcache: new Map(),\n\t\tmaxSize: 100,\n\t}\n\n\tconst { cache, maxSize, keyGetter } = { ...defaults, ...options }\n\n\treturn async (...args: Args) => {\n\t\tconst key = keyGetter(...args)\n\n\t\tif (cache.has(key)) return cache.get(key)!\n\n\t\tconst result = await fn(...args)\n\n\t\tcache.set(key, result)\n\n\t\tif (cache.size > maxSize) {\n\t\t\tcache.delete(cache.keys().next().value)\n\t\t}\n\n\t\treturn result\n\t}\n}\n","import { rank } from '../utils/rank'\nimport { unwikify } from '../utils/formatters'\nimport { baseLang, getLangName, LangCode } from '../utils/langNames'\nimport { pipe } from 'fp-ts/function'\nimport { uniq } from '../utils/uniq'\nimport { escapeForSparqlUrl } from './escapeSparqlUrlSegment'\nimport { urls } from '../config'\nimport { ancestor, Branch, sparqlClient } from './sparql'\nimport { regex } from 'fancy-regex'\n\nconst toLangPathSegments = (lang: LangCode) =>\n\tlang === baseLang ? baseLang : [baseLang, lang].join('/')\n\nconst toEtyTreeUri = (word: string, lang: LangCode) =>\n\t[\n\t\turls.etytreeNamespace,\n\t\ttoLangPathSegments(lang),\n\t\t`__ee_1_${escapeForSparqlUrl(word)}`,\n\t].join('/')\n\nexport type WordData = {\n\tword: string\n\tlangName: string\n\tlangCode: LangCode\n}\n\nconst getEtyTreePathname = (etytreeUrl: string) => {\n\ttry {\n\t\treturn new URL(etytreeUrl, urls.etytreeNamespace).pathname\n\t} catch {\n\t\treturn etytreeUrl\n\t}\n}\n\nconst toWordData = (etytreePathname: string): WordData => {\n\tconst { pathname } = new URL(etytreePathname, urls.etytreeNamespace)\n\tconst [_word, code] = pathname.split('/').reverse()\n\n\tconst langName = getLangName(code)\n\tconst word = unwikify(_word.replace(/^__ee_(?:\\d_+)?/, ''))\n\n\treturn {\n\t\tword,\n\t\tlangName,\n\t\tlangCode: code as LangCode,\n\t}\n}\n\nexport type CognateRaw = {\n\tancestor: string\n\tsrc: string[]\n\ttrg: string[]\n}\n\nexport type CognateHydrated = {\n\tancestor: WordData\n\tsrc: WordData[]\n\ttrg: WordData[]\n}\n\ntype CognateResult = {\n\tquery: string\n\tcognates: CognateRaw[]\n}\n\ntype CognateError = {\n\tquery: string\n\terror: string\n\tcode?: number\n}\n\nexport const isCognateError = (\n\tx: CognateResult | CognateError,\n): x is CognateError => {\n\treturn !!(x as any).error\n}\n\ntype SparqlParams = {\n\tword: string\n\tsrcLang: LangCode\n\ttrgLang: LangCode\n\tallowAffixes: boolean\n\tdepth?: number\n}\n\nexport const buildSparqlQuery = ({\n\tword,\n\tsrcLang,\n\ttrgLang,\n\tallowAffixes,\n\tdepth = 3,\n}: SparqlParams) => {\n\tconst trgLangMatcher = `/${toLangPathSegments(trgLang)}/__`\n\tconst uri = toEtyTreeUri(word, srcLang)\n\n\tconst source = '?source'\n\tconst target = '?target'\n\tconst makeAncestor = (level: number, branchId?: Branch) =>\n\t\t`?${ancestor}${level}${branchId ?? ''}`\n\tconst etymologicallyRelatedTo = 'dbetym:etymologicallyRelatedTo?'\n\n\tconst makeWalker = (varName: string, branchId: Branch, depth: number) =>\n\t\t[...new Array(depth)]\n\t\t\t.map(\n\t\t\t\t(_, i, arr) =>\n\t\t\t\t\t`\\t\\t${\n\t\t\t\t\t\ti === arr.length - 1\n\t\t\t\t\t\t\t? varName\n\t\t\t\t\t\t\t: makeAncestor(i + 1, branchId)\n\t\t\t\t\t} ${etymologicallyRelatedTo} ${\n\t\t\t\t\t\ti === 0 ? makeAncestor(0) : makeAncestor(i, branchId)\n\t\t\t\t\t} .`,\n\t\t\t)\n\t\t\t.join('\\n')\n\n\tconst walkers = [\n\t\tmakeWalker(source, 'a', depth),\n\t\tmakeWalker(target, 'b', depth),\n\t].join('\\n\\n')\n\n\tconst toAffixExcluderLine = (varName: string) =>\n\t\t`\\t\\t&& !regex(${varName}, \"_-|-$\", '')`\n\n\tconst affixExcluders = allowAffixes\n\t\t? ''\n\t\t: '\\n' +\n\t\t  [...new Array(depth)]\n\t\t\t\t.flatMap((_, i) =>\n\t\t\t\t\ti === 0\n\t\t\t\t\t\t? [\n\t\t\t\t\t\t\t\ttoAffixExcluderLine('?target'),\n\t\t\t\t\t\t\t\ttoAffixExcluderLine(makeAncestor(0)),\n\t\t\t\t\t\t  ]\n\t\t\t\t\t\t: [\n\t\t\t\t\t\t\t\ttoAffixExcluderLine(makeAncestor(i, 'a')),\n\t\t\t\t\t\t\t\ttoAffixExcluderLine(makeAncestor(i, 'b')),\n\t\t\t\t\t\t  ],\n\t\t\t\t)\n\t\t\t\t.join('\\n')\n\n\tconst sparql = `SELECT DISTINCT * {\n\tBIND (<${uri}> as ${source})\n\n\t{\n${walkers}\n\t}\n\n\tFILTER (\n\t\t${source} != ${target}\n\t\t&& regex(${target}, \"${trgLangMatcher}\", '')${affixExcluders}\n\t) .\n}\nGROUP BY ${target}\nLIMIT 500`\n\n\treturn { sparql, trgLangMatcher, uri }\n}\n\nexport const fetchCognates = async (\n\tword: string,\n\tsrcLang: LangCode,\n\ttrgLang: LangCode,\n\tallowAffixes: boolean,\n): Promise<CognateResult | CognateError> => {\n\tconst { sparql, uri } = buildSparqlQuery({\n\t\tword,\n\t\tsrcLang,\n\t\ttrgLang,\n\t\tallowAffixes,\n\t})\n\n\tconst res = await sparqlClient.fetch(sparql)\n\n\tif (res.kind === 'error') {\n\t\tconsole.error(res.error)\n\n\t\treturn { query: sparql, ...res }\n\t} else {\n\t\tconst bindings = res.results.bindings\n\n\t\tconst etymologies = bindings.map((binding) => {\n\t\t\tconst { target, ancestor0 } = binding\n\n\t\t\tconst toAncestorRegex = (branchId: Branch) =>\n\t\t\t\tregex`^${ancestor}\\d${branchId}$`\n\n\t\t\tconst toAncestorVals = (branchId: Branch) => {\n\t\t\t\tconst re = toAncestorRegex(branchId)\n\n\t\t\t\treturn Object.entries(binding)\n\t\t\t\t\t.filter(([k]) => re.test(k))\n\t\t\t\t\t.map(([, v]) => v)\n\t\t\t}\n\n\t\t\tconst aAncestorVals = toAncestorVals('a')\n\n\t\t\tconst bAncestorVals = toAncestorVals('b')\n\n\t\t\treturn {\n\t\t\t\tancestor: getEtyTreePathname(ancestor0.value),\n\t\t\t\tsrc: pipe(\n\t\t\t\t\t[ancestor0, ...aAncestorVals, { value: uri }].map((x) =>\n\t\t\t\t\t\tgetEtyTreePathname(x.value),\n\t\t\t\t\t),\n\t\t\t\t\tuniq(),\n\t\t\t\t)\n\t\t\t\t\t.slice(1) // rm ancestor0\n\t\t\t\t\t.filter(Boolean),\n\t\t\t\ttrg: pipe(\n\t\t\t\t\t[ancestor0, ...bAncestorVals, target].map((x) =>\n\t\t\t\t\t\tgetEtyTreePathname(x.value),\n\t\t\t\t\t),\n\t\t\t\t\tuniq(),\n\t\t\t\t)\n\t\t\t\t\t.slice(1) // rm ancestor0\n\t\t\t\t\t.filter(Boolean),\n\t\t\t}\n\t\t})\n\n\t\tconst cognates = pipe(\n\t\t\tetymologies,\n\n\t\t\t(x) =>\n\t\t\t\tx.sort(\n\t\t\t\t\trank([\n\t\t\t\t\t\t({ trg }) => trg.length,\n\t\t\t\t\t\t({ src }) => src.length,\n\t\t\t\t\t\t({ trg }) => trg[trg.length - 1]?.length,\n\t\t\t\t\t]),\n\t\t\t\t),\n\n\t\t\tuniq(({ trg }) => trg[trg.length - 1]),\n\t\t)\n\n\t\treturn { query: sparql, cognates }\n\t}\n}\n\nexport const hydrate = (raw: CognateRaw[]): CognateHydrated[] =>\n\tpipe(\n\t\traw.map(({ src, trg, ancestor }) => ({\n\t\t\tancestor: toWordData(ancestor),\n\t\t\tsrc: src.map(toWordData),\n\t\t\ttrg: trg.map(toWordData),\n\t\t})),\n\t\tuniq(\n\t\t\t({ trg }) => trg[trg.length - 1]?.langCode,\n\t\t\t({ trg }) => trg[trg.length - 1]?.word,\n\t\t),\n\t)\n","import { FC } from 'react'\n\nexport const Spinner: FC = () => {\n\treturn <p className='grayed-out'>Loading...</p>\n}\n","const updateUrl = <T>(\n\turl: URL,\n\tk: string,\n\tv: T,\n\tserialize: (str: T) => string | null,\n) => {\n\tconst val = serialize(v)\n\n\tif (val == null) {\n\t\turl.searchParams.delete(k)\n\t} else {\n\t\turl.searchParams.set(k, val)\n\t}\n}\n\ntype QueryOpts<\n\tT extends unknown = any,\n\tD extends unknown = any,\n\tS extends string | null = string,\n> = {\n\tparse: (val: string) => T\n\tserialize: (val: T) => S\n\tdefaultValue: D\n}\n\ntype QpsInit<T extends Record<keyof T, QueryOpts>> = {\n\t[K in keyof T]: T[K]\n}\n\nexport type RawQpTypes<T extends Record<string, QueryOpts>> = {\n\t[k in keyof T]: ReturnType<T[k]['parse']> | T[k]['defaultValue']\n}\n\nexport const windowHistoryFn = (method: 'pushState' | 'replaceState') =>\n\t(({ search }: URL) => {\n\t\tconst url = new URL(window.location.href)\n\n\t\turl.search = search\n\n\t\twindow.history[method]({}, document.title, url.href)\n\t}) as ({ search }: Pick<URL, 'search'>) => void\n\nexport const pseudoHistory = (url: URL): History => ({\n\tpush: ({ search }) => {\n\t\turl.search = search\n\t},\n\treplace: ({ search }) => {\n\t\turl.search = search\n\t},\n})\n\nexport type History = {\n\tpush: ({ search }: Pick<URL, 'search'>) => void\n\treplace: ({ search }: Pick<URL, 'search'>) => void\n}\n\nexport const createQps = <T extends Record<keyof T, QueryOpts<any, any, any>>>(\n\tinit: QpsInit<T>,\n\thistory: History = {\n\t\tpush: windowHistoryFn('pushState'),\n\t\treplace: windowHistoryFn('replaceState'),\n\t},\n) => {\n\treturn {\n\t\tget<K extends keyof T & string>(\n\t\t\tk: K,\n\t\t): ReturnType<T[K]['parse']> | T[K]['defaultValue'] {\n\t\t\tconst url = new URL(window.location.href)\n\n\t\t\tconst v = url.searchParams.get(k)\n\n\t\t\treturn v == null ? init[k].defaultValue : init[k].parse(v)\n\t\t},\n\t\tset<K extends keyof T & string, V extends ReturnType<T[K]['parse']>>(\n\t\t\tk: K,\n\t\t\tv: V,\n\t\t\tpushState?: boolean,\n\t\t) {\n\t\t\tconst url = new URL(window.location.href)\n\n\t\t\tupdateUrl(url, k, v, init[k].serialize)\n\n\t\t\tconst { search } = url\n\n\t\t\t// no-op if same location\n\t\t\tif (search === window.location.search) return\n\n\t\t\thistory[pushState ? 'push' : 'replace']({ search })\n\t\t},\n\t\tdelete<K extends keyof T & string>(k: K, pushState?: boolean): void {\n\t\t\tconst url = new URL(window.location.href)\n\n\t\t\turl.searchParams.delete(k)\n\n\t\t\tconst { search } = url\n\n\t\t\thistory[pushState ? 'push' : 'replace']({ search })\n\t\t},\n\t\tsetMany(\n\t\t\tupdates: Partial<{\n\t\t\t\t[k in keyof T]: ReturnType<T[k]['parse']>\n\t\t\t}>,\n\t\t\tpushState?: boolean,\n\t\t) {\n\t\t\tconst url = new URL(window.location.href)\n\n\t\t\tfor (const [k, v] of Object.entries(updates)) {\n\t\t\t\t// if unrecognized query param, just convert to string\n\t\t\t\tconst serialize = init[k as keyof T]?.serialize ?? String\n\n\t\t\t\tupdateUrl(url, k, v, serialize)\n\t\t\t}\n\n\t\t\tconst { search } = url\n\n\t\t\thistory[pushState ? 'push' : 'replace']({ search })\n\t\t},\n\t\tgetMany<K extends keyof T & string>(\n\t\t\tks: K[],\n\t\t): {\n\t\t\t[k in K]: ReturnType<T[k]['parse']> | T[k]['defaultValue']\n\t\t} {\n\t\t\tconst url = new URL(window.location.href)\n\n\t\t\treturn Object.fromEntries(\n\t\t\t\tks.map((k) => {\n\t\t\t\t\tconst val = url.searchParams.get(k)\n\n\t\t\t\t\treturn [\n\t\t\t\t\t\tk,\n\t\t\t\t\t\tval == null ? init[k].defaultValue : init[k].parse(val),\n\t\t\t\t\t]\n\t\t\t\t}),\n\t\t\t) as {\n\t\t\t\t[k in K]: ReturnType<T[k]['parse']> | T[k]['defaultValue']\n\t\t\t}\n\t\t},\n\t\tgetAll(): RawQpTypes<T> {\n\t\t\tconst url = new URL(window.location.href)\n\n\t\t\treturn Object.fromEntries(\n\t\t\t\tObject.keys(init).map((k) => {\n\t\t\t\t\tconst val = url.searchParams.get(k)\n\t\t\t\t\tconst key = k as keyof typeof init\n\n\t\t\t\t\treturn [\n\t\t\t\t\t\tk,\n\t\t\t\t\t\tval == null\n\t\t\t\t\t\t\t? init[key].defaultValue\n\t\t\t\t\t\t\t: init[key].parse(val),\n\t\t\t\t\t]\n\t\t\t\t}),\n\t\t\t) as RawQpTypes<T>\n\t\t},\n\t}\n}\n\ntype QpTypeOptions = {\n\tomitIfDefault: boolean\n}\n\nconst defaultQpTypeOptions: QpTypeOptions = {\n\tomitIfDefault: false,\n}\n\ntype SerializeVal<T extends QpTypeOptions> = T extends {\n\tomitIfDefault: true\n}\n\t? string | null\n\t: string\n\nconst applyOptions = <A extends any, B extends any, O extends QpTypeOptions>(\n\tqueryOpts: QueryOpts<A, B, string>,\n\topts?: O,\n) => {\n\tconst { parse, serialize, defaultValue } = queryOpts\n\n\tconst { omitIfDefault } = {\n\t\t...defaultQpTypeOptions,\n\t\t...opts,\n\t}\n\n\tconst serialize_ = omitIfDefault\n\t\t? (val: A) => (val === defaultValue ? null : serialize(val))\n\t\t: serialize\n\n\treturn {\n\t\tparse,\n\t\tserialize: serialize_,\n\t\tdefaultValue,\n\t} as QueryOpts<A, B, SerializeVal<O>>\n}\n\nexport const qpType = {\n\tnumber: <D extends number | null, O extends QpTypeOptions>(\n\t\tdefaultValue: D,\n\t\topts?: O,\n\t) => {\n\t\treturn applyOptions(\n\t\t\t{\n\t\t\t\tparse: Number,\n\t\t\t\tserialize: String,\n\t\t\t\tdefaultValue,\n\t\t\t},\n\t\t\topts,\n\t\t)\n\t},\n\n\tboolean: <D extends boolean | null, O extends QpTypeOptions>(\n\t\tdefaultValue: D,\n\t\topts?: O,\n\t) => {\n\t\treturn applyOptions(\n\t\t\t{\n\t\t\t\tparse: (x: string) => x === 'true',\n\t\t\t\tserialize: String,\n\t\t\t\tdefaultValue,\n\t\t\t},\n\t\t\topts,\n\t\t)\n\t},\n\n\tstring: <\n\t\tT extends string = string,\n\t\tD extends T | null = T,\n\t\tO extends QpTypeOptions = QpTypeOptions,\n\t>(\n\t\tdefaultValue: D,\n\t\topts?: O,\n\t) => {\n\t\treturn applyOptions(\n\t\t\t{\n\t\t\t\tparse: (x: string) => x as T,\n\t\t\t\tserialize: (x: T) => x,\n\t\t\t\tdefaultValue,\n\t\t\t},\n\t\t\topts,\n\t\t)\n\t},\n\n\tjson: <\n\t\tT extends any = any,\n\t\tD extends any = T,\n\t\tO extends QpTypeOptions = QpTypeOptions,\n\t>(\n\t\tdefaultValue: D,\n\t\topts?: O,\n\t) => {\n\t\treturn applyOptions(\n\t\t\t{\n\t\t\t\tparse: JSON.parse,\n\t\t\t\tserialize: JSON.stringify,\n\t\t\t\tdefaultValue,\n\t\t\t},\n\t\t\topts,\n\t\t)\n\t},\n}\nexport const getQpDefaults = <T extends Record<string, QueryOpts>>(\n\tx: T,\n): RawQpTypes<T> => {\n\treturn Object.fromEntries(\n\t\tObject.entries(x).map(([k, v]) => [k, v.defaultValue]),\n\t) as RawQpTypes<T>\n}\n","import { LangCode } from './langNames'\nimport { pick } from './pick'\nimport { qpType, createQps, History } from './qps'\n\nexport const qpInit = {\n\tword: qpType.string(''),\n\tsrcLang: qpType.string<LangCode>('spa'),\n\ttrgLang: qpType.string<LangCode>('eng'),\n\tallowAffixes: qpType.boolean(false, { omitIfDefault: true }),\n\n\tpage: qpType.number(1, { omitIfDefault: true }),\n\n\tshareText: qpType.string(null, { omitIfDefault: true }),\n}\n\n// https://stackoverflow.com/a/62620115/\nexport const initQps = (history?: History) => {\n\treturn createQps(qpInit, history)\n}\n\nexport type Qps = ReturnType<typeof initQps>\n\nexport const getFormValues = (qps: Qps) => {\n\treturn pick(['word', 'srcLang', 'trgLang', 'allowAffixes'], qps.getAll())\n}\n\nexport type FormValues = ReturnType<typeof getFormValues>\n","export function pick<T, K extends string & keyof T>(ks: K[], o: T): Pick<T, K> {\n\treturn Object.fromEntries(\n\t\tObject.entries(o).filter(([k]) => ks.includes(k as K)),\n\t) as Pick<T, K>\n}\n","type ValidityKey = Exclude<keyof ValidityState, 'valid' | 'customError'>\n\nexport type CustomValidityMessages = Partial<\n\tRecord<ValidityKey, (value: string) => string>\n>\n\nexport type FormEl = HTMLInputElement | HTMLSelectElement\n\nconst setValidity = (messages: CustomValidityMessages) => (el: FormEl) => {\n\tconst { value, validity } = el\n\n\tif (validity.valid) {\n\t\tel.setCustomValidity('')\n\n\t\treturn\n\t}\n\n\tconst fn = Object.entries(messages).find(\n\t\t([key]) => validity[key as ValidityKey],\n\t)?.[1]\n\n\tel.setCustomValidity(fn?.(value) ?? '')\n}\n\nexport const attachCustomValidityMessages =\n\t(messages: CustomValidityMessages) => (el: FormEl | null) => {\n\t\tif (el) {\n\t\t\tconst setValidity_ = setValidity(messages)\n\n\t\t\tsetValidity_(el)\n\n\t\t\tconst listener = (e: Event) =>\n\t\t\t\tsetValidity_(e.currentTarget as FormEl)\n\n\t\t\tel.addEventListener('input', listener)\n\n\t\t\treturn function cleanup() {\n\t\t\t\tel.removeEventListener('input', listener)\n\t\t\t}\n\t\t}\n\t}\n","export const isTouchDevice = () =>\n\twindow.matchMedia('(pointer: coarse)').matches\n\n// https://developer.mozilla.org/en-US/docs/Web/HTTP/Browser_detection_using_the_user_agent#mobile_tablet_or_desktop\nexport const isMobile = navigator.userAgent.includes('Mobi')\n\nexport const clickInteraction = isMobile ? 'tap' : 'click'\n","import { useState } from 'react'\n\nlet inc = 0\n\nexport const generateHtmlId = (prefix = 'id') => `${prefix}-${++inc}`\n\nexport const useHtmlId = (prefix = 'id') => {\n\tconst [htmlId /* , setHtmlId */] = useState(generateHtmlId(prefix))\n\n\treturn htmlId\n}\n","import { FC, useEffect, useState } from 'react'\nimport { UseFormSetValue } from 'react-hook-form'\nimport {\n\tgetLangName,\n\tLangCode,\n\tlangCodes,\n\tLangName,\n\tlangNames,\n\tlangNamesToCodes,\n} from '../utils/langNames'\nimport { useHtmlId } from '../hooks/useHtmlId'\n\nexport const LangSelect: FC<{\n\tid: string\n\tlangCode: LangCode\n\tsetLangCode: UseFormSetValue<any> // TODO\n}> = ({ id, langCode, setLangCode }) => {\n\tconst [enteredText, setEnteredText] = useState(() => getLangName(langCode))\n\n\tuseEffect(() => {\n\t\tif (langCodes.includes(langCode)) {\n\t\t\tsetEnteredText(getLangName(langCode))\n\t\t}\n\t}, [langCode])\n\n\tconst listId = useHtmlId(`${id}-list`)\n\n\treturn (\n\t\t<>\n\t\t\t<input\n\t\t\t\tid={id}\n\t\t\t\ttype='text'\n\t\t\t\tlist={listId}\n\t\t\t\tvalue={enteredText}\n\t\t\t\tplaceholder={getLangName(langCode)}\n\t\t\t\tonChange={(e) => {\n\t\t\t\t\tconst value = e.currentTarget.value\n\n\t\t\t\t\tsetEnteredText(value)\n\n\t\t\t\t\tconst langCode = langNamesToCodes[value as LangName]\n\n\t\t\t\t\tif (langCodes.includes(langCode)) {\n\t\t\t\t\t\tsetLangCode(id, langCode)\n\t\t\t\t\t}\n\t\t\t\t}}\n\t\t\t\tonFocus={() => setEnteredText('')}\n\t\t\t\tonBlur={() => setEnteredText(getLangName(langCode))}\n\t\t\t/>\n\n\t\t\t<datalist id={listId}>\n\t\t\t\t{langNames.map((x) => (\n\t\t\t\t\t<option key={x} value={x}>\n\t\t\t\t\t\t{x}\n\t\t\t\t\t</option>\n\t\t\t\t))}\n\t\t\t</datalist>\n\t\t</>\n\t)\n}\n","import {\n\tEventHandler,\n\tFC,\n\tFragment,\n\tKeyboardEventHandler,\n\tuseCallback,\n\tuseRef,\n\tuseState,\n\tSyntheticEvent,\n} from 'react'\nimport { UseFormReturn } from 'react-hook-form'\nimport { Link } from 'react-router-dom'\nimport { urls } from '../config'\nimport { useValidationMessages } from '../hooks/useValidationMessages'\nimport { isMobile } from '../utils/device'\nimport { makeCognateFinderUrl, toRelativeUrl } from '../utils/formatters'\nimport { FormValues } from '../utils/setupQps'\nimport { nextAnimationFrame } from '../utils/timing'\nimport { LangSelect } from './LangSelect'\nimport { Tooltip } from './Tooltip'\n\ntype WiktionaryOpenSearchSuggestions = [\n\tinput: string,\n\tsuggestions: string[],\n\tdesciptions: string[],\n\turls: string[],\n]\n\nexport const CognateSearchForm: FC<{\n\tonSubmit: (values: FormValues) => Promise<void>\n\tform: UseFormReturn<FormValues>\n\tseeAlsos: string[]\n}> = ({ onSubmit, form, seeAlsos }) => {\n\tconst formRef = useRef<HTMLFormElement>(null)\n\n\tconst { register, handleSubmit, watch, setValue } = form\n\n\tconst [autocompleteOptions, setAutocompleteOptions] = useState<string[]>([])\n\tconst [input, setInput] = useState('')\n\n\tconst word = watch('word')\n\n\tconst srcLang = watch('srcLang')\n\tconst trgLang = watch('trgLang')\n\n\tconst swap = useCallback(\n\t\t(e: React.MouseEvent<HTMLElement>) => {\n\t\t\te.preventDefault()\n\n\t\t\tconst trgLang = watch('trgLang')\n\t\t\tconst srcLang = watch('srcLang')\n\n\t\t\tsetValue('srcLang', trgLang)\n\t\t\tsetValue('trgLang', srcLang)\n\t\t},\n\t\t[setValue, watch],\n\t)\n\n\tconst lastSubmittedAt = useRef(-1)\n\n\tconst submit = useCallback<EventHandler<SyntheticEvent>>(\n\t\t(e) => {\n\t\t\te.preventDefault()\n\n\t\t\t// rate limited to once per second\n\t\t\t// - avoid double-submit on `Enter` keydown\n\t\t\tconst now = Date.now()\n\n\t\t\tif (now - lastSubmittedAt.current > 1e3) {\n\t\t\t\thandleSubmit(onSubmit)(e)\n\t\t\t\tlastSubmittedAt.current = now\n\t\t\t}\n\t\t},\n\t\t[handleSubmit, onSubmit],\n\t)\n\n\tconst onKeyDown = useCallback<KeyboardEventHandler<HTMLInputElement>>(\n\t\t(e) => {\n\t\t\tif (!input) return\n\n\t\t\t// is 'Unidentified' if event triggered by selecting an\n\t\t\t// existing autocomplete option in desktop Chrome;\n\t\t\t// however, mobile Chrome always returns 'Unidentified' (?!?!?)\n\t\t\tconst onAutocompleteSelectKeys = isMobile\n\t\t\t\t? ['Enter']\n\t\t\t\t: ['Unidentified', 'Enter']\n\n\t\t\tif (onAutocompleteSelectKeys.includes(e.key)) {\n\t\t\t\t// wait for `e.currentTarget.value` to update first\n\t\t\t\tnextAnimationFrame().then(() => submit(e))\n\n\t\t\t\treturn\n\t\t\t}\n\n\t\t\tconst controller = new AbortController()\n\n\t\t\tconst url = new URL(urls.wiktionaryActionApi)\n\n\t\t\turl.searchParams.set('action', 'opensearch')\n\t\t\turl.searchParams.set('search', input)\n\n\t\t\tfetch(url.href, {\n\t\t\t\tsignal: controller.signal,\n\t\t\t})\n\t\t\t\t.then(async (res) => {\n\t\t\t\t\tconst [, suggestions] =\n\t\t\t\t\t\t(await res.json()) as WiktionaryOpenSearchSuggestions\n\n\t\t\t\t\tsetAutocompleteOptions(suggestions)\n\t\t\t\t})\n\t\t\t\t.catch((e) => {\n\t\t\t\t\tif (e instanceof DOMException && e.name === 'AbortError') {\n\t\t\t\t\t\t// request aborted — ignore\n\t\t\t\t\t} else {\n\t\t\t\t\t\tthrow e\n\t\t\t\t\t}\n\t\t\t\t})\n\n\t\t\treturn () => {\n\t\t\t\tcontroller.abort()\n\t\t\t}\n\t\t},\n\t\t[input, submit],\n\t)\n\n\tconst { ref: wordFormRef, ...registerWord } = register('word')\n\n\tconst wordValidationRef = useValidationMessages(\n\t\t{\n\t\t\tvalueMissing: () => 'Enter a word to search for',\n\t\t},\n\t\tfalse,\n\t)\n\n\treturn (\n\t\t<form\n\t\t\tclassName='search-form y-gap-between'\n\t\t\tref={formRef}\n\t\t\tonSubmit={submit}\n\t\t>\n\t\t\t<div className='long-field'>\n\t\t\t\t<label htmlFor='word'>\n\t\t\t\t\tWord{' '}\n\t\t\t\t\t<input\n\t\t\t\t\t\trequired\n\t\t\t\t\t\tonKeyDown={onKeyDown}\n\t\t\t\t\t\tonInput={(e) => setInput(e.currentTarget.value)}\n\t\t\t\t\t\tref={(el) => {\n\t\t\t\t\t\t\twordFormRef(el)\n\n\t\t\t\t\t\t\tObject.assign(wordValidationRef, { current: el })\n\t\t\t\t\t\t}}\n\t\t\t\t\t\tid='word'\n\t\t\t\t\t\ttype='search'\n\t\t\t\t\t\tautoCapitalize='none'\n\t\t\t\t\t\tvalue={word}\n\t\t\t\t\t\t{...registerWord}\n\t\t\t\t\t\tlist='main-search'\n\t\t\t\t\t\tplaceholder='Search for definitions, cognates, and translations'\n\t\t\t\t\t\tautoFocus\n\t\t\t\t\t/>\n\t\t\t\t\t<datalist id='main-search'>\n\t\t\t\t\t\t{autocompleteOptions.map((option) => (\n\t\t\t\t\t\t\t<option key={option} value={option}>\n\t\t\t\t\t\t\t\t{option}\n\t\t\t\t\t\t\t</option>\n\t\t\t\t\t\t))}\n\t\t\t\t\t</datalist>\n\t\t\t\t</label>{' '}\n\t\t\t\t{seeAlsos.length ? (\n\t\t\t\t\t<div className='see-alsos'>\n\t\t\t\t\t\tSee also:{' '}\n\t\t\t\t\t\t{seeAlsos.map((word, idx, arr) => (\n\t\t\t\t\t\t\t<Fragment key={idx}>\n\t\t\t\t\t\t\t\t<Link\n\t\t\t\t\t\t\t\t\tto={toRelativeUrl(\n\t\t\t\t\t\t\t\t\t\tmakeCognateFinderUrl({ word, srcLang }),\n\t\t\t\t\t\t\t\t\t)}\n\t\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t\t{word}\n\t\t\t\t\t\t\t\t</Link>\n\t\t\t\t\t\t\t\t{idx !== arr.length - 1 ? ', ' : ''}\n\t\t\t\t\t\t\t</Fragment>\n\t\t\t\t\t\t))}\n\t\t\t\t\t</div>\n\t\t\t\t) : null}\n\t\t\t</div>\n\t\t\t<div className='short-field'>\n\t\t\t\t<label htmlFor='srcLang'>\n\t\t\t\t\tSource{' '}\n\t\t\t\t\t<LangSelect\n\t\t\t\t\t\tid='srcLang'\n\t\t\t\t\t\tlangCode={srcLang}\n\t\t\t\t\t\tsetLangCode={setValue}\n\t\t\t\t\t/>\n\t\t\t\t</label>{' '}\n\t\t\t</div>\n\t\t\t<div className='short-field'>\n\t\t\t\t<Tooltip title='Swap languages' enterTouchDelay={300}>\n\t\t\t\t\t<button className='swap' type='button' onClick={swap}>\n\t\t\t\t\t\t<span aria-hidden='true'>⇄</span>\n\t\t\t\t\t</button>\n\t\t\t\t</Tooltip>{' '}\n\t\t\t</div>\n\t\t\t<div className='short-field'>\n\t\t\t\t<label htmlFor='trgLang'>\n\t\t\t\t\tTarget{' '}\n\t\t\t\t\t<LangSelect\n\t\t\t\t\t\tid='trgLang'\n\t\t\t\t\t\tlangCode={trgLang}\n\t\t\t\t\t\tsetLangCode={setValue}\n\t\t\t\t\t/>\n\t\t\t\t</label>\n\t\t\t</div>\n\t\t\t{/*\n\t\t\t\tTODO: possibly re-add? might be confusing for users,\n\t\t\t\tprobably hide behind \"advanced options\"\n\t\t\t*/}\n\t\t\t{/* <div>\n\t\t\t\t<label htmlFor='allowAffixes'>\n\t\t\t\t\tAllow prefixes and suffixes{' '}\n\t\t\t\t\t<input\n\t\t\t\t\t\ttype='checkbox'\n\t\t\t\t\t\tid='allowAffixes'\n\t\t\t\t\t\t{...register('allowAffixes')}\n\t\t\t\t\t/>\n\t\t\t\t</label>\n\t\t\t</div> */}\n\t\t\t<div className='long-field'>\n\t\t\t\t<button type='submit'>Search</button>{' '}\n\t\t\t</div>\n\t\t</form>\n\t)\n}\n","export const sleep = (ms: number) =>\n\tnew Promise<void>((res) => setTimeout(res, ms))\n\nexport const nextAnimationFrame = () =>\n\tnew Promise<number>((res) => requestAnimationFrame(res))\n","import { useRef, useEffect, useState } from 'react'\nimport {\n\tCustomValidityMessages,\n\tattachCustomValidityMessages,\n\tFormEl,\n} from '../dom/attachCustomValidityMessages'\n\nexport const useValidationMessages = (\n\tmessages: CustomValidityMessages,\n\tdynamic: boolean = true,\n) => {\n\tconst validationRef = useRef<FormEl>(null)\n\n\tconst [m] = useState(messages)\n\n\tconst _messages = dynamic ? messages : m\n\n\tconst cleanup = useRef<() => void>(null)\n\n\tuseEffect(() => {\n\t\tif (validationRef.current) {\n\t\t\tcleanup.current?.()\n\n\t\t\tconst c = attachCustomValidityMessages(_messages)(\n\t\t\t\tvalidationRef.current,\n\t\t\t)\n\n\t\t\tObject.assign(cleanup, { current: c })\n\t\t}\n\t}, [validationRef, _messages])\n\n\treturn validationRef\n}\n","export const parseSeeAlsos = (text: string) =>\n\t(text.match(/{{(also(?:\\|[^|}]+)+)}}/)?.[1] ?? '')\n\t\t.split('|')\n\t\t.slice(1)\n\t\t// remove special pages\n\t\t.filter((x) => !/[:/]/.test(x))\n\t\t// ignore anything that couldn't be parsed\n\t\t.filter(Boolean)\n","import { regex } from 'fancy-regex'\n\ntype HasGroups<T extends string> = RegExpMatchArray & {\n\tgroups: Record<T, string>\n}\n\n// {{xyz}} syntax, used for templates in MediaWiki\n// regexes with `u` flags set must escape all literal {braces}\nconst wrap = (...args: [x: TemplateStringsArray, ...rest: any[]]) =>\n\tregex`\\{\\{${regex(...args)}\\}\\}`\n\n// for example:\n// {{trans-top|meaning description here}}\n// ...\n// {{trans-bottom}}\nconst allTranslationsRegex = regex('gu')`\n\t${wrap`\n\t\ttrans-top(?:-also)? \\|\n\t\t(?:\n\t\t\tid=[^|}]+ \\|\n\t\t)?\n\t\t(?<meaning>\n\t\t\t[^|}]+\n\t\t)\n\t\t(?:\n\t\t\t\\| [^}]+\n\t\t)?\n\t`}\n\t(?<translations>[\\s\\S]+?)\n\t${wrap`trans-bottom`}\n`\n\n// for example:\n// * Korean: {{tt+|ko|사람}}, {{tt+|ko|인(人)}} {{qualifier|suffix}}, {{tt+|ko|분}} {{qualifier|honorific}}\nconst translationLineRegex = regex('u')`\n\t^\n\t\t\\s*\\*:?\\s+(?<langName>[^:]+):\\s+(?<trData>.+)\n\t$\n`\n\n// for example:\n// {{tt+|ko|분}} {{qualifier|honorific}}\n// where `word` is 분\nconst individualTranslationRegex = regex('u')`\n\t^\n\t\t${wrap`t{1,2}\\+?\\|\\w+\\|(?<word>[^|}]+)(?:[^}]+)?`}\n\t\t(?:\\s+${wrap`(?:[^}]+)`})*\n\t$\n`\n\nconst cleanIndividualTranslation = (tr: string) => tr.replace(/[[\\]]/g, '')\n\nconst toTranslationsObj = (translations: string) => {\n\tconst kvs = (\n\t\ttranslations\n\t\t\t.split(/\\r\\n|[\\r\\n]/)\n\t\t\t.map((line) => line.match(translationLineRegex))\n\t\t\t.filter(Boolean) as any as HasGroups<'langName' | 'trData'>[]\n\t)\n\t\t.map(({ groups: { langName, trData } }) => {\n\t\t\tconst words = trData\n\t\t\t\t.split(/\\s*,\\s*/)\n\t\t\t\t.map((x) => x.match(individualTranslationRegex)?.groups?.word)\n\t\t\t\t.filter(Boolean)\n\t\t\t\t.map((x) => cleanIndividualTranslation(x!))\n\n\t\t\treturn words.length && [langName, words]\n\t\t})\n\t\t.filter(Boolean) as [string, string[]][]\n\n\treturn Object.fromEntries(kvs)\n}\n\nexport const parseTranslations = (text: string) =>\n\t[\n\t\t...(text.matchAll(allTranslationsRegex) as any as HasGroups<\n\t\t\t'meaning' | 'translations'\n\t\t>[]),\n\t].map(({ groups: { meaning, translations } }) => ({\n\t\tmeaning,\n\t\ttranslations: toTranslationsObj(translations),\n\t}))\n\nexport type Translations = ReturnType<typeof parseTranslations>\n","import { urls } from '../config'\nimport { forceCapitalize, underscorify } from '../utils/formatters'\nimport { withCache } from '../utils/withCache'\n\ntype WiktionaryApiSuccess = {\n\tparse: {\n\t\twikitext?: {\n\t\t\t'*'?: string\n\t\t}\n\t}\n}\n\nconst errorCodes = ['missingtitle'] as const\n\ntype WiktionaryApiError = {\n\terror: {\n\t\t'*'?: string\n\t\tcode?: typeof errorCodes[number]\n\t\tinfo?: string\n\t}\n}\n\ntype WikitextApiResponse = WiktionaryApiSuccess | WiktionaryApiError\n\nconst isApiError = (x: WikitextApiResponse): x is WiktionaryApiError => {\n\treturn (x as any).error\n}\n\ntype SuccessResult = {\n\tword: string\n\tkind: 'success'\n\tdata: string\n}\n\ntype ErrorResult = {\n\tword: string\n\tkind: 'error'\n\terror: Error\n\tprefetchedVariants: SuccessResult[]\n}\n\ntype Result = SuccessResult | ErrorResult\n\nconst fetchFromApi = withCache(\n\tnull,\n\tasync (word: string): Promise<WikitextApiResponse> => {\n\t\tconst url = new URL(urls.wiktionaryActionApi)\n\n\t\tfor (const [k, v] of [\n\t\t\t['action', 'parse'],\n\t\t\t['format', 'json'],\n\t\t\t['prop', 'wikitext'],\n\t\t\t['page', underscorify(word)],\n\t\t]) {\n\t\t\turl.searchParams.set(k, v)\n\t\t}\n\n\t\tconst res = await fetch(url.href)\n\t\tconst data: WikitextApiResponse = await res.json()\n\n\t\treturn data\n\t},\n)\n\nconst createSuccessResult = (\n\tword: string,\n\tdata: WiktionaryApiSuccess,\n): SuccessResult => {\n\tconst text = data.parse.wikitext?.['*'] ?? ''\n\n\treturn { word, kind: 'success' as const, data: text }\n}\n\nexport const fetchWiktionaryPageResult = async (\n\tword: string,\n): Promise<Result> => {\n\tconst data = await fetchFromApi(word)\n\n\tif (isApiError(data)) {\n\t\tconst msg = data.error.info ?? ''\n\n\t\tconst prefetchedVariants: SuccessResult[] = []\n\n\t\tconst variants = [\n\t\t\tword.toLowerCase(),\n\t\t\tforceCapitalize(word),\n\t\t\tword.toUpperCase(),\n\t\t].filter((x) => x !== word)\n\n\t\tfor (const variant of variants) {\n\t\t\tif (data.error.code === 'missingtitle' && word !== variant) {\n\t\t\t\tconst variantData = await fetchFromApi(variant)\n\n\t\t\t\tif (!isApiError(variantData)) {\n\t\t\t\t\tconst r = createSuccessResult(variant, variantData)\n\n\t\t\t\t\tprefetchedVariants.push(r)\n\n\t\t\t\t\t// break early if 1 variant found\n\t\t\t\t\t// — others will typically be shown under \"See also\"\n\t\t\t\t\t// on the first variant's page\n\t\t\t\t\tbreak\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\tconst result = {\n\t\t\tword,\n\t\t\tkind: 'error' as const,\n\t\t\terror: new Error(msg),\n\t\t\tprefetchedVariants,\n\t\t}\n\n\t\treturn result\n\t} else {\n\t\tconst result = createSuccessResult(word, data)\n\n\t\treturn result\n\t}\n}\n","import { useState } from 'react'\n\ntype Options = {\n\tpageSize: number\n\tstartPage: number\n}\n\nconst defaultOptions: Options = {\n\tpageSize: 50,\n\tstartPage: 1,\n}\n\nexport const usePagination = (\n\titems: { length: number },\n\toptions?: Partial<Options>,\n) => {\n\tconst { pageSize, startPage } = {\n\t\t...defaultOptions,\n\t\t...options,\n\t}\n\n\tconst [page, setPage] = useState(startPage)\n\n\tconst { length } = items\n\n\tconst pageStart = (page - 1) * pageSize\n\tconst pageEnd = pageStart + pageSize\n\tconst maxPageNo = Math.ceil(length / pageSize)\n\n\tconst incrementPage = () => setPage((page) => Math.min(page + 1, maxPageNo))\n\tconst decrementPage = () => setPage((page) => Math.max(page - 1, 1))\n\n\treturn {\n\t\tpage,\n\t\tsetPage,\n\t\tpageSize,\n\t\tpageStart,\n\t\tpageEnd,\n\t\tmaxPageNo,\n\t\tincrementPage,\n\t\tdecrementPage,\n\t}\n}\n\nexport type UsePaginationReturn = ReturnType<typeof usePagination>\n","import { getLangName, LangCode, langNamesToCodes } from '../utils/langNames'\nimport { makeCognateFinderUrl, unwikify, wikify } from '../utils/formatters'\nimport { urls } from '../config'\nimport { ls } from '../utils/ls'\nimport { withCache } from '../utils/withCache'\n\ntype Section = {\n\ttoclevel: number\n\ttext: string\n\tline: string\n}\n\nconst partsOfSpeech = [\n\t// https://en.wiktionary.org/wiki/Wiktionary:Entry_layout#Part_of_speech\n\t// General\n\t'adjective',\n\t'adverb',\n\t'ambiposition',\n\t'article',\n\t'circumposition',\n\t'classifier',\n\t'conjunction',\n\t'contraction',\n\t'counter',\n\t'determiner',\n\t'ideophone',\n\t'interjection',\n\t'noun',\n\t'numeral',\n\t'participle',\n\t'particle',\n\t'postposition',\n\t'preposition',\n\t'pronoun',\n\t'proper noun',\n\t'verb',\n\t// Morphemes\n\t'circumfix',\n\t'combining form',\n\t'infix',\n\t'interfix',\n\t'prefix',\n\t'root',\n\t'suffix',\n\t// Symbols and characters\n\t'diacritical mark',\n\t'letter',\n\t'ligature',\n\t'number',\n\t'punctuation mark',\n\t'syllable',\n\t'symbol',\n\t// Phrases\n\t'phrase',\n\t'proverb',\n\t'prepositional phrase',\n\t// Han characters and language-specific varieties\n\t'han character',\n\t'hanzi',\n\t'kanji',\n\t'hanja',\n\t// Other\n\t'romanization',\n\t'logogram',\n]\n\nexport const fetchWordSections = withCache(null, async (word: string) => {\n\tconst res = await fetch(\n\t\t`${urls.wiktionaryRestApi}/rest_v1/page/mobile-sections/${wikify(\n\t\t\tword,\n\t\t)}`,\n\t)\n\n\tconst data = (await res.json()) as {\n\t\tremaining?: {\n\t\t\tsections: Section[]\n\t\t}\n\t}\n\n\tconst sections = data.remaining?.sections ?? []\n\n\treturn sections\n})\n\nconst getDefinitionDomForLanguage = (\n\tword: string,\n\tsections: Section[],\n\tlanguage: string,\n) => {\n\tconst word_ = word\n\n\tconst start = sections.findIndex(\n\t\t(s) => s.toclevel === 1 && s.line === language,\n\t)\n\tconst _end = sections.slice(start + 1).findIndex((s) => s.toclevel === 1)\n\tconst end = _end === -1 ? sections.length : _end + start + 1\n\n\tconst { text } = sections\n\t\t.slice(start, end)\n\t\t.find((x) => partsOfSpeech.includes(x.line.trim().toLowerCase())) ?? {\n\t\ttext: '',\n\t}\n\n\tconst doc = new DOMParser().parseFromString(text, 'text/html')\n\n\tconst base = doc.createElement('base')\n\tbase.href = urls.wiktionaryWeb\n\n\tdoc.head.appendChild(base)\n\n\tfor (const el of doc.body.querySelectorAll('.maintenance-line')) {\n\t\tel.remove()\n\t}\n\n\tfor (const link of doc.body.querySelectorAll<HTMLAnchorElement>(\n\t\t'a[href]',\n\t)) {\n\t\tconst rawHref = link.getAttribute('href')!\n\n\t\tconst originalUrl = new URL(rawHref, urls.wiktionaryWeb)\n\n\t\tif (originalUrl.origin !== new URL(urls.wiktionaryWeb).origin) {\n\t\t\t// is non-Wiktionary URL\n\n\t\t\tlink.target = '_blank'\n\t\t\tlink.rel = 'noreferrer noopener'\n\t\t} else {\n\t\t\t// is Wiktionary URL\n\n\t\t\tconst rawWord = originalUrl.pathname.replace('/wiki/', '')\n\t\t\tconst parsedWord = unwikify(rawWord ?? '')\n\n\t\t\tconst srcLangName = originalUrl.hash.slice(1)\n\n\t\t\tconst srcLangCode: LangCode = srcLangName\n\t\t\t\t? langNamesToCodes[srcLangName as keyof typeof langNamesToCodes]\n\t\t\t\t: 'eng'\n\n\t\t\tconst isHashOnlyLink = rawHref.startsWith('#')\n\n\t\t\tif (\n\t\t\t\t!isHashOnlyLink &&\n\t\t\t\t(!srcLangCode || !rawWord || /[:/]/.test(rawWord))\n\t\t\t) {\n\t\t\t\t// is special Wiktionary URL/unrecognized language\n\n\t\t\t\t// not a no-op; forces href to use base URL from `head > base` of `parsed` when `innerHTML` is read\n\t\t\t\tlink.href = link.href!\n\n\t\t\t\tlink.target = '_blank'\n\t\t\t\tlink.rel = 'noreferrer noopener'\n\t\t\t} else {\n\t\t\t\tconst word = isHashOnlyLink ? word_ : parsedWord\n\n\t\t\t\tlink.href = makeCognateFinderUrl({ word, srcLang: srcLangCode })\n\t\t\t}\n\t\t}\n\t}\n\n\treturn doc.querySelector('body')!\n}\n\nconst cache = new Map<string, string>()\nconst keyGetter = (word: string, langCode: LangCode) =>\n\tJSON.stringify([word, langCode])\n\nif (ls.lastSubmitted && ls.definition) {\n\tconst { word, srcLang } = ls.lastSubmitted\n\n\tcache.set(keyGetter(word, srcLang), ls.definition)\n}\n\nexport const fetchWiktionaryDefinitionHtml = withCache(\n\t{\n\t\tcache,\n\t\tkeyGetter,\n\t},\n\tasync (word: string, langCode: LangCode) => {\n\t\tlet result: string\n\n\t\ttry {\n\t\t\tconst sections = await fetchWordSections(word)\n\n\t\t\tresult =\n\t\t\t\tgetDefinitionDomForLanguage(\n\t\t\t\t\tword,\n\t\t\t\t\tsections,\n\t\t\t\t\tgetLangName(langCode),\n\t\t\t\t).querySelector('ol')?.outerHTML ?? ''\n\t\t} catch (e) {\n\t\t\tconsole.error(e)\n\t\t\tresult = ''\n\t\t}\n\n\t\treturn result\n\t},\n)\n","import { createContext, useState } from 'react'\nimport { Switch, Route, useHistory } from 'react-router-dom'\nimport { NotFound } from './pages/NotFound'\nimport { SearchResults } from './pages/SearchResults'\nimport { ShareTarget } from './pages/ShareTarget'\nimport { pseudoHistory } from './utils/qps'\nimport { Qps, initQps } from './utils/setupQps'\n\nexport const QpsContext = createContext<Qps>(\n\tinitQps(pseudoHistory(new URL(window.location.href))),\n)\n\nexport enum Path {\n\tHome = '/',\n\tShareTarget = '/share-target',\n\tCognates = '/cognates',\n\tDefinition = '/definition',\n\tTranslations = '/translations',\n}\n\nexport const Routes = () => {\n\tconst history = useHistory()\n\n\tconst [qps] = useState<Qps>(() => initQps(history))\n\n\treturn (\n\t\t<QpsContext.Provider value={qps}>\n\t\t\t<Switch>\n\t\t\t\t<Route exact path={Path.ShareTarget}>\n\t\t\t\t\t<ShareTarget />\n\t\t\t\t</Route>\n\t\t\t\t<Route\n\t\t\t\t\texact\n\t\t\t\t\tpath={[\n\t\t\t\t\t\tPath.Home,\n\t\t\t\t\t\tPath.Definition,\n\t\t\t\t\t\tPath.Cognates,\n\t\t\t\t\t\tPath.Translations,\n\t\t\t\t\t]}\n\t\t\t\t>\n\t\t\t\t\t<SearchResults />\n\t\t\t\t</Route>\n\t\t\t\t<Route path='*'>\n\t\t\t\t\t<NotFound />\n\t\t\t\t</Route>\n\t\t\t</Switch>\n\t\t</QpsContext.Provider>\n\t)\n}\n","export const isLink = (target: EventTarget): target is HTMLAnchorElement =>\n\t(target as HTMLElement)?.matches?.('a[href]')\n\nexport const isSameOrigin = (url: string) =>\n\tnew URL(url).origin === window.location.origin\n","import { Fragment } from 'react'\nimport { DomNodeToReactParser } from '.'\nimport { kebabToCamel } from '../../utils/formatters'\n\nconst isTextNode = (node: Node): node is Text =>\n\tnode.nodeType === Node.TEXT_NODE\n\nconst isHtmlElementNode = (node: Node): node is HTMLElement =>\n\tnode.nodeType === Node.ELEMENT_NODE\n\n// todo: use more sophisticated allow-list logic\nconst allowedAttrs = [\n\t'href',\n\t'title',\n\t'target',\n\t'rel',\n\t'lang',\n\t'class',\n\t'about',\n\t'id',\n\t'typeof',\n]\n\nconst allowedPrefixes = ['data', 'aria'].map((x) => x + '-')\n\nconst isAllowedAttr = (attr: string, value: string) => {\n\treturn (\n\t\tallowedAttrs.includes(attr) ||\n\t\tallowedPrefixes.some(attr.startsWith.bind(attr))\n\t)\n}\n\nconst reactProps: Record<string, string> = {\n\tclass: 'className',\n}\n\nconst styleStrToObj = (style: string) =>\n\tObject.fromEntries(\n\t\tstyle\n\t\t\t.split(';')\n\t\t\t.map(\n\t\t\t\t(x) =>\n\t\t\t\t\tx\n\t\t\t\t\t\t.trim()\n\t\t\t\t\t\t.split(':')\n\t\t\t\t\t\t.map((y, i) =>\n\t\t\t\t\t\t\ti ? y.trim() : kebabToCamel(y.trim()),\n\t\t\t\t\t\t) as [string, string | undefined],\n\t\t\t)\n\t\t\t.filter(Boolean),\n\t)\n\ntype StyleObj = ReturnType<typeof styleStrToObj>\n\nexport const mapDomToReact = (parseCustomNode: DomNodeToReactParser) => {\n\tconst mapDomToReact_ = (node: Node) => {\n\t\tif (isTextNode(node)) {\n\t\t\treturn <Fragment>{node.data}</Fragment>\n\t\t} else if (isHtmlElementNode(node)) {\n\t\t\tconst customNode = parseCustomNode(node)\n\n\t\t\tif (customNode) return customNode\n\n\t\t\tconst El = node.nodeName.toLowerCase()\n\n\t\t\ttry {\n\t\t\t\tconst props: Record<string, string | StyleObj> = {}\n\n\t\t\t\tfor (const { name, value } of node.attributes) {\n\t\t\t\t\tif (isAllowedAttr(name, value)) {\n\t\t\t\t\t\tprops[reactProps[name] ?? name] = value\n\t\t\t\t\t} else if (name === 'style') {\n\t\t\t\t\t\tprops.style = styleStrToObj(value)\n\t\t\t\t\t} else {\n\t\t\t\t\t\tconsole.warn('Attribute blocked: ', name, value)\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\treturn node.textContent ? (\n\t\t\t\t\t<El {...(props as any)}>\n\t\t\t\t\t\t{[...node.childNodes].map((n, i) => (\n\t\t\t\t\t\t\t<Fragment key={i}>{mapDomToReact_(n)}</Fragment>\n\t\t\t\t\t\t))}\n\t\t\t\t\t</El>\n\t\t\t\t) : (\n\t\t\t\t\t<El {...props} />\n\t\t\t\t)\n\t\t\t} catch (e) {\n\t\t\t\tconsole.error(e)\n\n\t\t\t\treturn node.innerHTML ? (\n\t\t\t\t\t<El\n\t\t\t\t\t\t{...({\n\t\t\t\t\t\t\tdangerouslySetInnerHTML: { __html: node.innerHTML },\n\t\t\t\t\t\t} as any)}\n\t\t\t\t\t/>\n\t\t\t\t) : (\n\t\t\t\t\t<El />\n\t\t\t\t)\n\t\t\t}\n\t\t} else {\n\t\t\treturn <></>\n\t\t}\n\t}\n\n\treturn mapDomToReact_\n}\n","import { Fragment } from 'react'\nimport { mapDomToReact } from './mapDomToReact'\nimport { parseStringToDom } from './parseStringToDom'\n\nexport type DomNodeToReactParser = (node: Node) => JSX.Element | null\n\nexport const renderAsReactDom = (parser: DomNodeToReactParser) => {\n\tconst mapper = mapDomToReact(parser)\n\n\treturn (text: string) =>\n\t\tparseStringToDom(text).map((x, i) => (\n\t\t\t<Fragment key={i}>{mapper(x)}</Fragment>\n\t\t))\n}\n","export const parseStringToDom = (str: string) => {\n\tconst dom = new DOMParser().parseFromString(str, 'text/html')\n\n\treturn [...dom.body.childNodes]\n}\n","import { FC } from 'react'\nimport { renderAsReactDom } from '../dom/renderAsReactDom'\nimport { CognateLink } from '../components/CognateLink'\nimport { DomNodeToReactParser } from '../dom/renderAsReactDom'\nimport { isSameOrigin } from '../utils/browser'\nimport { getExtendedLangName, LangCode } from '../utils/langNames'\n\ntype Props = {\n\tword: string\n\tlangCode: LangCode\n\tdangerousHtml: string | null\n}\n\nexport const customParse: DomNodeToReactParser = (node: Node) => {\n\tif (node instanceof HTMLAnchorElement && isSameOrigin(node.href)) {\n\t\tconst { searchParams } = new URL(node.href)\n\n\t\tconst word = searchParams.get('word') ?? ''\n\t\tconst langCode = (searchParams.get('langCode') as LangCode) ?? 'eng'\n\n\t\treturn (\n\t\t\t<CognateLink {...{ word, langCode }}>\n\t\t\t\t{node.textContent ?? ''}\n\t\t\t</CognateLink>\n\t\t)\n\t}\n\n\treturn null\n}\n\nexport const nullParse: DomNodeToReactParser = () => null\n\nexport const createWiktionaryHtmlRenderer = (\n\tparser: DomNodeToReactParser,\n): FC<Props> => {\n\tconst render = renderAsReactDom(parser)\n\n\treturn ({ dangerousHtml, langCode, word }) =>\n\t\tdangerousHtml ? (\n\t\t\t<div>{render(dangerousHtml)}</div>\n\t\t) : (\n\t\t\t<p>\n\t\t\t\t<span className='grayed-out'>\n\t\t\t\t\tNo {getExtendedLangName(langCode)} definitions found for{' '}\n\t\t\t\t\t<em>{word}</em>\n\t\t\t\t</span>\n\t\t\t</p>\n\t\t)\n}\n\nexport const WiktionaryHtml = createWiktionaryHtmlRenderer(nullParse)\n\nexport const WiktionaryHtmlRootLevel = createWiktionaryHtmlRenderer(customParse)\n","import { FC } from 'react'\n\ntype Props = {\n\twiktionaryUrl: string\n\ttitle: string\n}\n\nexport const WiktionaryTitleLink: FC<Props> = ({ wiktionaryUrl, title }) => {\n\treturn (\n\t\t<div>\n\t\t\t<strong>\n\t\t\t\t<a\n\t\t\t\t\ttarget='blank'\n\t\t\t\t\trel='noreferrer noopener'\n\t\t\t\t\thref={wiktionaryUrl}\n\t\t\t\t>\n\t\t\t\t\t{title} — Wiktionary\n\t\t\t\t</a>\n\t\t\t</strong>\n\t\t</div>\n\t)\n}\n","import clsx from 'clsx'\nimport {\n\tFC,\n\tHTMLProps,\n\tMouseEventHandler,\n\tuseCallback,\n\tuseEffect,\n\tuseMemo,\n\tuseRef,\n\tuseState,\n} from 'react'\nimport { usePopper } from 'react-popper'\nimport { Link, useHistory } from 'react-router-dom'\nimport { WordData } from '../core/cognates'\nimport { fetchWiktionaryDefinitionHtml } from '../core/getWikiContent'\nimport { isLink, isSameOrigin } from '../utils/browser'\nimport { isTouchDevice } from '../utils/device'\nimport {\n\tmakeCognateFinderUrl,\n\tmakeWiktionarySearchUrl,\n\tmakeWiktionaryUrl,\n\ttoRelativeUrl,\n} from '../utils/formatters'\nimport { getExtendedLangName } from '../utils/langNames'\nimport { Spinner } from './Spinner'\nimport { WiktionaryHtml } from './WiktionaryHtml'\nimport { WiktionaryTitleLink } from './WiktionaryTitleLink'\n\ntype ReactEventName = `on${Capitalize<string>}` &\n\tkeyof React.DOMAttributes<HTMLAnchorElement>\n\nexport const CognateLink: FC<\n\tPartial<WordData> &\n\t\tPick<WordData, 'word' | 'langCode'> &\n\t\tHTMLProps<HTMLAnchorElement>\n> = ({ word, langCode, children, langName: _, className, ...htmlProps }) => {\n\tconst [referenceElement, setReferenceElement] =\n\t\tuseState<HTMLElement | null>(null)\n\tconst [popperElement, setPopperElement] = useState<HTMLElement | null>(null)\n\n\tconst ref = useRef<HTMLSpanElement>(null)\n\n\tconst { styles, attributes, forceUpdate } = usePopper(\n\t\treferenceElement,\n\t\tpopperElement,\n\t\t{\n\t\t\tplacement: 'auto',\n\t\t\tstrategy: 'absolute',\n\t\t\tmodifiers: [\n\t\t\t\t{\n\t\t\t\t\tname: 'preventOverflow',\n\t\t\t\t\toptions: {\n\t\t\t\t\t\trootBoundary: 'viewport',\n\t\t\t\t\t},\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tname: 'flip',\n\t\t\t\t\toptions: {\n\t\t\t\t\t\trootBoundary: 'viewport',\n\n\t\t\t\t\t\tmainAxis: true,\n\t\t\t\t\t\tflipVariations: true,\n\t\t\t\t\t\tpadding: 8,\n\t\t\t\t\t\tallowedAutoPlacements: [\n\t\t\t\t\t\t\t'auto',\n\t\t\t\t\t\t\t'auto-start',\n\t\t\t\t\t\t\t'auto-end',\n\t\t\t\t\t\t\t'bottom-start',\n\t\t\t\t\t\t\t'bottom-end',\n\t\t\t\t\t\t\t'right-start',\n\t\t\t\t\t\t\t'right-end',\n\t\t\t\t\t\t\t'left-start',\n\t\t\t\t\t\t\t'left-end',\n\t\t\t\t\t\t\t'bottom',\n\t\t\t\t\t\t],\n\t\t\t\t\t},\n\t\t\t\t},\n\t\t\t],\n\t\t},\n\t)\n\n\tconst [popoverHtml, setPopoverHtml] = useState<string | null>(null)\n\n\tconst history = useHistory()\n\n\tconst cognateFinderUrl = makeCognateFinderUrl({\n\t\tword,\n\t\tsrcLang: langCode,\n\t})\n\n\tconst wiktionaryUrl = useMemo(\n\t\t() =>\n\t\t\tpopoverHtml === ''\n\t\t\t\t? makeWiktionarySearchUrl({ word })\n\t\t\t\t: makeWiktionaryUrl({ word, langCode }),\n\t\t[word, langCode, popoverHtml],\n\t)\n\n\tconst [open, setOpen] = useState<boolean>(false)\n\tconst [loading, setLoading] = useState<boolean>(false)\n\n\tconst extendedLangName = getExtendedLangName(langCode)\n\n\tconst title = `${word} (${extendedLangName})`\n\n\tconst showPopover = useCallback(async () => {\n\t\tsetOpen(true)\n\n\t\tif (!popoverHtml) {\n\t\t\tsetLoading(true)\n\n\t\t\tconst html = await fetchWiktionaryDefinitionHtml(word, langCode)\n\n\t\t\tsetLoading(false)\n\n\t\t\tsetPopoverHtml(html ?? '')\n\t\t}\n\t}, [langCode, popoverHtml, word])\n\n\tuseEffect(() => {\n\t\tforceUpdate?.()\n\t}, [popoverHtml, forceUpdate])\n\n\tconst hidePopover = useCallback(() => {\n\t\tsetOpen(false)\n\t}, [])\n\n\tconst reactHoverEventNames: ReactEventName[] = useMemo(\n\t\t() =>\n\t\t\tisTouchDevice() ? ['onMouseOver', 'onTouchStart'] : ['onMouseOver'],\n\t\t[],\n\t)\n\n\tconst htmlHoverEventNames = useMemo(\n\t\t() =>\n\t\t\treactHoverEventNames.map((name) =>\n\t\t\t\tname.slice(2).toLowerCase(),\n\t\t\t) as (keyof HTMLElementEventMap)[],\n\t\t[reactHoverEventNames],\n\t)\n\n\tconst onEvents = useMemo(() => {\n\t\treturn Object.fromEntries(\n\t\t\treactHoverEventNames.map((k) => [k, showPopover]),\n\t\t) as Record<ReactEventName, typeof showPopover>\n\t}, [showPopover, reactHoverEventNames])\n\n\tconst hidePopoverIfNotCurrentTarget = useCallback(\n\t\t(e: Event) => {\n\t\t\tif (!ref.current?.contains(e.target as HTMLElement)) {\n\t\t\t\thidePopover()\n\t\t\t}\n\t\t},\n\t\t[hidePopover],\n\t)\n\n\tconst offEvents = useMemo(() => {\n\t\treturn Object.fromEntries(\n\t\t\thtmlHoverEventNames.map((k) => [k, hidePopoverIfNotCurrentTarget]),\n\t\t) as Record<ReactEventName, typeof hidePopoverIfNotCurrentTarget>\n\t}, [hidePopoverIfNotCurrentTarget, htmlHoverEventNames])\n\n\tconst suppressOnEsc = useCallback(\n\t\t(e: KeyboardEvent) => {\n\t\t\tif (e.key === 'Escape') {\n\t\t\t\thidePopover()\n\t\t\t}\n\t\t},\n\t\t[hidePopover],\n\t)\n\n\tuseEffect(() => {\n\t\tif (!open) return\n\n\t\tObject.entries(offEvents).forEach(([k, v]) => {\n\t\t\tdocument.body.addEventListener(k, v)\n\t\t})\n\n\t\twindow.addEventListener('keydown', suppressOnEsc)\n\n\t\treturn function cleanup() {\n\t\t\tObject.entries(offEvents).forEach(([k, v]) => {\n\t\t\t\tdocument.body.removeEventListener(k, v)\n\t\t\t})\n\n\t\t\twindow.removeEventListener('keydown', suppressOnEsc)\n\t\t}\n\t}, [offEvents, open, suppressOnEsc])\n\n\tconst onClick: MouseEventHandler<HTMLDivElement> = useCallback(\n\t\t(e) => {\n\t\t\tif (isLink(e.target) && isSameOrigin(e.target.href)) {\n\t\t\t\te.preventDefault()\n\n\t\t\t\thidePopover()\n\n\t\t\t\thistory?.push(toRelativeUrl(e.target.href))\n\t\t\t}\n\t\t},\n\t\t[history, hidePopover],\n\t)\n\n\treturn (\n\t\t<span ref={ref} className='popover-parent'>\n\t\t\t<span ref={setReferenceElement}>\n\t\t\t\t<Link\n\t\t\t\t\tclassName={clsx([className, 'cognate-link'])}\n\t\t\t\t\t{...(htmlProps as any)}\n\t\t\t\t\t{...onEvents}\n\t\t\t\t\tonClick={hidePopover}\n\t\t\t\t\tto={toRelativeUrl(cognateFinderUrl)}\n\t\t\t\t>\n\t\t\t\t\t{children ?? title}\n\t\t\t\t</Link>\n\t\t\t</span>\n\n\t\t\t{open && (\n\t\t\t\t<div\n\t\t\t\t\tref={setPopperElement}\n\t\t\t\t\t{...attributes.popper}\n\t\t\t\t\tstyle={styles.popper}\n\t\t\t\t\tclassName='popover'\n\t\t\t\t>\n\t\t\t\t\t{loading ? (\n\t\t\t\t\t\t<Spinner />\n\t\t\t\t\t) : (\n\t\t\t\t\t\t<div onClick={onClick}>\n\t\t\t\t\t\t\t<WiktionaryTitleLink\n\t\t\t\t\t\t\t\t{...{\n\t\t\t\t\t\t\t\t\ttitle: popoverHtml ? title : word,\n\t\t\t\t\t\t\t\t\twiktionaryUrl,\n\t\t\t\t\t\t\t\t}}\n\t\t\t\t\t\t\t/>\n\n\t\t\t\t\t\t\t<WiktionaryHtml\n\t\t\t\t\t\t\t\t{...{ word, langCode }}\n\t\t\t\t\t\t\t\tdangerousHtml={popoverHtml}\n\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t)}\n\t\t\t\t</div>\n\t\t\t)}\n\t\t</span>\n\t)\n}\n","import { FC } from 'react'\nimport { CognateHydrated } from '../core/cognates'\nimport { CognateLink } from './CognateLink'\n\nexport const CognatesList: FC<{\n\tcognates: CognateHydrated[]\n\tpageStart: number\n\tpageEnd: number\n}> = ({ cognates, pageStart, pageEnd }) => {\n\treturn (\n\t\t<ul>\n\t\t\t{cognates\n\t\t\t\t.slice(pageStart, pageEnd)\n\t\t\t\t.map(({ ancestor, trg, src }, i) => {\n\t\t\t\t\treturn (\n\t\t\t\t\t\t<li\n\t\t\t\t\t\t\tclassName='top-level-li'\n\t\t\t\t\t\t\tkey={[\n\t\t\t\t\t\t\t\ti,\n\t\t\t\t\t\t\t\ttrg[trg.length - 1]?.langCode ?? 'null',\n\t\t\t\t\t\t\t\ttrg[trg.length - 1]?.word ?? 'null',\n\t\t\t\t\t\t\t].join('-')}\n\t\t\t\t\t\t>\n\t\t\t\t\t\t\t<CognateLink\n\t\t\t\t\t\t\t\tclassName='cognate-link--lowlighted'\n\t\t\t\t\t\t\t\t{...ancestor}\n\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t<ul>\n\t\t\t\t\t\t\t\t<li>\n\t\t\t\t\t\t\t\t\t{src.flatMap((x, i) => [\n\t\t\t\t\t\t\t\t\t\t<span key={i - 0.5} className='arrow'>\n\t\t\t\t\t\t\t\t\t\t\t{' '}\n\t\t\t\t\t\t\t\t\t\t\t→{' '}\n\t\t\t\t\t\t\t\t\t\t</span>,\n\t\t\t\t\t\t\t\t\t\t<CognateLink\n\t\t\t\t\t\t\t\t\t\t\tclassName='cognate-link--lowlighted'\n\t\t\t\t\t\t\t\t\t\t\tkey={i}\n\t\t\t\t\t\t\t\t\t\t\t{...x}\n\t\t\t\t\t\t\t\t\t\t/>,\n\t\t\t\t\t\t\t\t\t])}\n\t\t\t\t\t\t\t\t</li>\n\t\t\t\t\t\t\t\t<li>\n\t\t\t\t\t\t\t\t\t{trg.flatMap((x, i, a) => [\n\t\t\t\t\t\t\t\t\t\t<span key={i - 0.5} className='arrow'>\n\t\t\t\t\t\t\t\t\t\t\t{' '}\n\t\t\t\t\t\t\t\t\t\t\t→{' '}\n\t\t\t\t\t\t\t\t\t\t</span>,\n\t\t\t\t\t\t\t\t\t\ti === a.length - 1 ? (\n\t\t\t\t\t\t\t\t\t\t\t<CognateLink\n\t\t\t\t\t\t\t\t\t\t\t\tkey={i}\n\t\t\t\t\t\t\t\t\t\t\t\tclassName='cognate-link--highlighted'\n\t\t\t\t\t\t\t\t\t\t\t\t{...x}\n\t\t\t\t\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t\t\t\t) : (\n\t\t\t\t\t\t\t\t\t\t\t<CognateLink\n\t\t\t\t\t\t\t\t\t\t\t\tkey={i}\n\t\t\t\t\t\t\t\t\t\t\t\tclassName='cognate-link--lowlighted'\n\t\t\t\t\t\t\t\t\t\t\t\t{...x}\n\t\t\t\t\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t\t\t\t),\n\t\t\t\t\t\t\t\t\t])}\n\t\t\t\t\t\t\t\t</li>\n\t\t\t\t\t\t\t</ul>\n\t\t\t\t\t\t</li>\n\t\t\t\t\t)\n\t\t\t\t})}\n\t\t</ul>\n\t)\n}\n","import { FC, Fragment } from 'react'\n\nexport const Pagination: FC<{\n\tmaxPageNo: number\n\tpage: number\n\tsetPage: (n: number, pushState?: boolean) => void\n}> = ({ maxPageNo, page, setPage }) => {\n\treturn (\n\t\t<>\n\t\t\t{Array.from({ length: maxPageNo }, (_, i) => {\n\t\t\t\treturn (\n\t\t\t\t\t<Fragment key={i}>\n\t\t\t\t\t\t{page === i + 1 ? (\n\t\t\t\t\t\t\ti + 1\n\t\t\t\t\t\t) : (\n\t\t\t\t\t\t\t<a\n\t\t\t\t\t\t\t\thref={`#page-${i + 1}`}\n\t\t\t\t\t\t\t\tonClick={(e) => {\n\t\t\t\t\t\t\t\t\te.preventDefault()\n\n\t\t\t\t\t\t\t\t\tsetPage(i + 1, true)\n\t\t\t\t\t\t\t\t}}\n\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t{i + 1}\n\t\t\t\t\t\t\t</a>\n\t\t\t\t\t\t)}\n\t\t\t\t\t\t{'\\xa0'}\n\t\t\t\t\t</Fragment>\n\t\t\t\t)\n\t\t\t})}\n\t\t</>\n\t)\n}\n","import { FC, useCallback, useContext } from 'react'\nimport { CognateHydrated } from '../core/cognates'\nimport { usePagination } from '../hooks/usePagination'\nimport { QpsContext } from '../Routes'\nimport { clickInteraction } from '../utils/device'\nimport { capitalize } from '../utils/formatters'\nimport { getExtendedLangName } from '../utils/langNames'\nimport { FormValues } from '../utils/setupQps'\nimport { CognatesList } from './CognatesList'\nimport { Pagination } from './Pagination'\n\ntype Props = {\n\tcognates: CognateHydrated[]\n\tlastSubmitted: FormValues\n\tword: string\n\tquery: string\n\terror: Error | null\n}\n\nexport const CognatesTab: FC<Props> = ({\n\tword,\n\tcognates,\n\tlastSubmitted,\n\tquery,\n\terror,\n}) => {\n\tconst qps = useContext(QpsContext)\n\n\tconst pagination = usePagination(cognates, {\n\t\tpageSize: 50,\n\t\tstartPage: qps.get('page'),\n\t})\n\n\tconst { setPage, page, pageStart, pageEnd, maxPageNo } = pagination\n\n\tconst hydrated = cognates\n\n\tconst updatePage = useCallback(\n\t\t(n: number, pushState?: boolean) => {\n\t\t\tsetPage(n)\n\n\t\t\tqps.set('page', n, pushState)\n\t\t},\n\t\t[setPage, qps],\n\t)\n\n\tconst { srcLang, trgLang } = lastSubmitted\n\n\treturn (\n\t\t<div className='y-margins'>\n\t\t\t<h2>Cognates</h2>\n\t\t\t{cognates.length ? (\n\t\t\t\t<>\n\t\t\t\t\t<div>\n\t\t\t\t\t\tTotal {cognates.length} results | Page{' '}\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\t<Pagination\n\t\t\t\t\t\t\t\t{...{\n\t\t\t\t\t\t\t\t\tpage,\n\t\t\t\t\t\t\t\t\tmaxPageNo,\n\t\t\t\t\t\t\t\t\tsetPage: updatePage,\n\t\t\t\t\t\t\t\t}}\n\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t}\n\t\t\t\t\t</div>\n\t\t\t\t</>\n\t\t\t) : null}\n\n\t\t\t<div>\n\t\t\t\t{error ? (\n\t\t\t\t\t<div>\n\t\t\t\t\t\t<strong>Error:</strong> {error.message}\n\t\t\t\t\t</div>\n\t\t\t\t) : cognates.length ? (\n\t\t\t\t\t<>\n\t\t\t\t\t\t<CognatesList\n\t\t\t\t\t\t\t{...{\n\t\t\t\t\t\t\t\tcognates: hydrated,\n\t\t\t\t\t\t\t\tpageStart,\n\t\t\t\t\t\t\t\tpageEnd,\n\t\t\t\t\t\t\t}}\n\t\t\t\t\t\t/>\n\t\t\t\t\t\tPage{' '}\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\t<Pagination\n\t\t\t\t\t\t\t\t{...{\n\t\t\t\t\t\t\t\t\tpage,\n\t\t\t\t\t\t\t\t\tmaxPageNo,\n\t\t\t\t\t\t\t\t\tsetPage: updatePage,\n\t\t\t\t\t\t\t\t}}\n\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t}\n\t\t\t\t\t</>\n\t\t\t\t) : word === lastSubmitted?.word ? (\n\t\t\t\t\tword ? (\n\t\t\t\t\t\t<>\n\t\t\t\t\t\t\t<p>\n\t\t\t\t\t\t\t\tNo {getExtendedLangName(trgLang)} cognates found\n\t\t\t\t\t\t\t\tfor {getExtendedLangName(srcLang)}{' '}\n\t\t\t\t\t\t\t\t<em>{word}</em>{' '}\n\t\t\t\t\t\t\t</p>\n\t\t\t\t\t\t</>\n\t\t\t\t\t) : (\n\t\t\t\t\t\t'Enter a word to search for cognates'\n\t\t\t\t\t)\n\t\t\t\t) : (\n\t\t\t\t\t`${capitalize(clickInteraction)} “Search” to find cognates`\n\t\t\t\t)}\n\n\t\t\t\t{cognates.length && word && query ? (\n\t\t\t\t\t<div className='y-margins'>\n\t\t\t\t\t\t<details>\n\t\t\t\t\t\t\t<summary>Show raw query</summary>\n\n\t\t\t\t\t\t\t<pre>{query}</pre>\n\t\t\t\t\t\t</details>\n\t\t\t\t\t</div>\n\t\t\t\t) : null}\n\t\t\t</div>\n\t\t</div>\n\t)\n}\n","import { pipe } from 'fp-ts/lib/function'\nimport { FC, Fragment } from 'react'\nimport { Link } from 'react-router-dom'\nimport {\n\tmakeCognateFinderUrl,\n\tmakeWiktionaryUrl,\n\ttoRelativeUrl,\n} from '../utils/formatters'\nimport { getLangName } from '../utils/langNames'\nimport { LangPair } from '../utils/ls'\nimport { FormValues } from '../utils/setupQps'\nimport { WiktionaryHtmlRootLevel } from './WiktionaryHtml'\nimport { WiktionaryTitleLink } from './WiktionaryTitleLink'\n\ntype Props = {\n\tdefinition: string | null\n\tlastSubmitted: FormValues\n\tsuggestedLangPairs: LangPair[]\n}\n\nconst isFlipped = (x: LangPair) => (y: LangPair) =>\n\tx.srcLang === y.trgLang && x.trgLang === y.srcLang\n\nexport const DefinitionTab: FC<Props> = ({\n\tdefinition,\n\tlastSubmitted,\n\tsuggestedLangPairs,\n}) => {\n\tconst { word, srcLang, trgLang } = lastSubmitted\n\n\tconst langName = getLangName(srcLang)\n\n\tconst title = `${word} (${langName})`\n\tconst wiktionaryUrl = makeWiktionaryUrl({ word, langCode: srcLang })\n\n\tconst suggestTryFlipped = suggestedLangPairs.find(isFlipped(lastSubmitted))\n\tconst otherSuggestions = suggestedLangPairs.filter(\n\t\t(x) => x !== suggestTryFlipped,\n\t)\n\n\treturn (\n\t\t<div className='y-margins'>\n\t\t\t<div className='y-margins'>\n\t\t\t\t<h2>Definition</h2>\n\n\t\t\t\t{!definition && suggestTryFlipped ? null : (\n\t\t\t\t\t<WiktionaryTitleLink\n\t\t\t\t\t\t{...{ title: definition ? title : word, wiktionaryUrl }}\n\t\t\t\t\t/>\n\t\t\t\t)}\n\n\t\t\t\t<WiktionaryHtmlRootLevel\n\t\t\t\t\t{...{ word, langCode: srcLang }}\n\t\t\t\t\tdangerousHtml={definition}\n\t\t\t\t/>\n\n\t\t\t\t{definition ? null : suggestTryFlipped ? (\n\t\t\t\t\t<p>\n\t\t\t\t\t\tDid you mean to search{' '}\n\t\t\t\t\t\t<strong>\n\t\t\t\t\t\t\t<Link\n\t\t\t\t\t\t\t\tto={toRelativeUrl(\n\t\t\t\t\t\t\t\t\tmakeCognateFinderUrl({\n\t\t\t\t\t\t\t\t\t\tword,\n\t\t\t\t\t\t\t\t\t\tsrcLang: trgLang,\n\t\t\t\t\t\t\t\t\t}),\n\t\t\t\t\t\t\t\t)}\n\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t{getLangName(trgLang)} → {getLangName(srcLang)}\n\t\t\t\t\t\t\t</Link>\n\t\t\t\t\t\t</strong>\n\t\t\t\t\t\t?\n\t\t\t\t\t</p>\n\t\t\t\t) : otherSuggestions.length ? (\n\t\t\t\t\t<p>\n\t\t\t\t\t\tSearch in{' '}\n\t\t\t\t\t\t{otherSuggestions.map(\n\t\t\t\t\t\t\t({ srcLang, trgLang }, idx, arr) => (\n\t\t\t\t\t\t\t\t<Fragment key={idx}>\n\t\t\t\t\t\t\t\t\t<Link\n\t\t\t\t\t\t\t\t\t\tto={pipe(\n\t\t\t\t\t\t\t\t\t\t\tmakeCognateFinderUrl({\n\t\t\t\t\t\t\t\t\t\t\t\tword,\n\t\t\t\t\t\t\t\t\t\t\t\tsrcLang,\n\t\t\t\t\t\t\t\t\t\t\t\ttrgLang,\n\t\t\t\t\t\t\t\t\t\t\t}),\n\t\t\t\t\t\t\t\t\t\t\ttoRelativeUrl,\n\t\t\t\t\t\t\t\t\t\t)}\n\t\t\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t\t\t{getLangName(srcLang)}\n\t\t\t\t\t\t\t\t\t</Link>\n\t\t\t\t\t\t\t\t\t{idx === arr.length - 1 ? null : ', '}\n\t\t\t\t\t\t\t\t</Fragment>\n\t\t\t\t\t\t\t),\n\t\t\t\t\t\t)}\n\t\t\t\t\t</p>\n\t\t\t\t) : null}\n\t\t\t</div>\n\t\t</div>\n\t)\n}\n","import clsx from 'clsx'\nimport { forwardRef, HTMLProps } from 'react'\nimport { NavLink } from 'react-router-dom'\nimport { Tooltip } from './Tooltip'\n\ntype Props = {\n\tto: string\n\texact: boolean\n} & (\n\t| {\n\t\t\tdisabled: boolean\n\t\t\tdisabledMessage: string\n\t  }\n\t| {\n\t\t\tdisabled?: undefined\n\t\t\tdisabledMessage?: undefined\n\t  }\n)\n\ntype HtmlProps = Omit<HTMLProps<HTMLAnchorElement>, 'ref'>\n\nexport const TabLink = forwardRef<HTMLAnchorElement, Props & HtmlProps>(\n\t(props, ref) => {\n\t\tconst { to, exact, disabled, disabledMessage, ...htmlProps } = props\n\n\t\treturn props.disabled ? (\n\t\t\t<Tooltip title={props.disabledMessage}>\n\t\t\t\t{/* eslint-disable-next-line jsx-a11y/anchor-is-valid */}\n\t\t\t\t<a\n\t\t\t\t\tref={ref}\n\t\t\t\t\t{...htmlProps}\n\t\t\t\t\tclassName={clsx(['disabled-tab', htmlProps.className])}\n\t\t\t\t>\n\t\t\t\t\t{props.children}\n\t\t\t\t</a>\n\t\t\t</Tooltip>\n\t\t) : (\n\t\t\t<NavLink\n\t\t\t\tref={ref}\n\t\t\t\tactiveClassName='active'\n\t\t\t\tto={props.to}\n\t\t\t\texact={props.exact}\n\t\t\t\t{...htmlProps}\n\t\t\t>\n\t\t\t\t{props.children}\n\t\t\t</NavLink>\n\t\t)\n\t},\n)\n","import { FC } from 'react'\nimport { LangCode } from '../utils/langNames'\nimport { CognateLink } from './CognateLink'\n\ntype Props = {\n\ttranslations: {\n\t\tmeaning: string\n\t\ttrgLang: LangCode\n\t\ttranslations: string[]\n\t}[]\n}\n\nexport const Translations: FC<Props> = ({ translations }) => {\n\treturn (\n\t\t<div>\n\t\t\t<ol>\n\t\t\t\t{translations.map(({ meaning, translations, trgLang }) => {\n\t\t\t\t\treturn (\n\t\t\t\t\t\t<li key={meaning}>\n\t\t\t\t\t\t\t<div className='y-margins'>\n\t\t\t\t\t\t\t\t{meaning}\n\t\t\t\t\t\t\t\t<ul>\n\t\t\t\t\t\t\t\t\t{translations.map((word) => (\n\t\t\t\t\t\t\t\t\t\t<li key={word}>\n\t\t\t\t\t\t\t\t\t\t\t<CognateLink\n\t\t\t\t\t\t\t\t\t\t\t\t{...{ word, langCode: trgLang }}\n\t\t\t\t\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t\t\t\t\t{word}\n\t\t\t\t\t\t\t\t\t\t\t</CognateLink>\n\t\t\t\t\t\t\t\t\t\t</li>\n\t\t\t\t\t\t\t\t\t))}\n\t\t\t\t\t\t\t\t</ul>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t</li>\n\t\t\t\t\t)\n\t\t\t\t})}\n\t\t\t</ol>\n\t\t</div>\n\t)\n}\n","import { FC } from 'react'\nimport { LangCode } from '../utils/langNames'\nimport { Translations } from './Translations'\n\ntype Props = {\n\ttranslations: {\n\t\tmeaning: string\n\t\ttrgLang: LangCode\n\t\ttranslations: string[]\n\t}[]\n}\n\nexport const TranslationsTab: FC<Props> = ({ translations }) => {\n\treturn (\n\t\t<div className='y-margins'>\n\t\t\t<div className='y-margins'>\n\t\t\t\t<h2>Translations</h2>\n\t\t\t\t<Translations translations={translations} />\n\t\t\t</div>\n\t\t</div>\n\t)\n}\n","import { FC, useEffect, useState } from 'react'\nimport { Route, Switch, useLocation } from 'react-router-dom'\nimport { CognateHydrated } from '../core/cognates'\nimport { Path } from '../Routes'\nimport { LangCode } from '../utils/langNames'\nimport { FormValues } from '../utils/setupQps'\nimport { CognatesTab } from './CognatesTab'\nimport { DefinitionTab } from './DefinitionTab'\nimport { TabLink } from './TabLink'\nimport { TranslationsTab } from './TranslationsTab'\nimport { Tooltip } from './Tooltip'\nimport { LangPair, ls } from '../utils/ls'\nimport { clickInteraction } from '../utils/device'\nimport { capitalize } from '../utils/formatters'\n\ntype Props = {\n\tlastSubmitted: FormValues\n\ttranslations: {\n\t\tmeaning: string\n\t\ttrgLang: LangCode\n\t\ttranslations: string[]\n\t}[]\n\tcognates: CognateHydrated[]\n\tword: string\n\tquery: string\n\terror: Error | null\n\tsuggestedLangPairs: LangPair[]\n\tdefinition: string | null\n}\n\nexport const Tabs: FC<Props> = ({\n\tlastSubmitted,\n\ttranslations,\n\tcognates,\n\tword,\n\tquery,\n\terror,\n\tsuggestedLangPairs,\n\tdefinition,\n}) => {\n\tconst { search } = useLocation()\n\n\tconst [open, setOpen] = useState(false)\n\n\tconst dismissTooltip = () => {\n\t\tls.cognatesTooltipDismissed = true\n\t\tsetOpen(false)\n\t}\n\n\tuseEffect(() => {\n\t\tif (!ls.cognatesTooltipDismissed) {\n\t\t\tsetOpen(Boolean(cognates.length))\n\t\t}\n\t}, [cognates])\n\n\treturn (\n\t\t<div className='y-margins tabs-outer'>\n\t\t\t<nav className='tabs'>\n\t\t\t\t<TabLink exact to={Path.Definition + search}>\n\t\t\t\t\tDefinition\n\t\t\t\t</TabLink>\n\n\t\t\t\t<Tooltip\n\t\t\t\t\topen={open}\n\t\t\t\t\tarrow\n\t\t\t\t\ttitle={\n\t\t\t\t\t\topen\n\t\t\t\t\t\t\t? `Cognates found! ${capitalize(\n\t\t\t\t\t\t\t\t\tclickInteraction,\n\t\t\t\t\t\t\t  )} here to view`\n\t\t\t\t\t\t\t: ''\n\t\t\t\t\t}\n\t\t\t\t\tclassName='tooltip--emphasized'\n\t\t\t\t\tonClick={dismissTooltip}\n\t\t\t\t>\n\t\t\t\t\t<TabLink\n\t\t\t\t\t\texact\n\t\t\t\t\t\tto={Path.Cognates + search}\n\t\t\t\t\t\tdisabled={!cognates.length}\n\t\t\t\t\t\tdisabledMessage='No cognates found'\n\t\t\t\t\t>\n\t\t\t\t\t\tCognates\n\t\t\t\t\t</TabLink>\n\t\t\t\t</Tooltip>\n\t\t\t\t<TabLink\n\t\t\t\t\texact\n\t\t\t\t\tto={Path.Translations + search}\n\t\t\t\t\tdisabled={!translations.length}\n\t\t\t\t\tdisabledMessage='No translations found'\n\t\t\t\t>\n\t\t\t\t\tTranslations\n\t\t\t\t</TabLink>\n\t\t\t</nav>\n\t\t\t<article translate='no'>\n\t\t\t\t<Switch>\n\t\t\t\t\t<Route exact path={Path.Definition}>\n\t\t\t\t\t\t<DefinitionTab\n\t\t\t\t\t\t\t{...{\n\t\t\t\t\t\t\t\tdefinition,\n\t\t\t\t\t\t\t\tlastSubmitted,\n\t\t\t\t\t\t\t\tsuggestedLangPairs,\n\t\t\t\t\t\t\t}}\n\t\t\t\t\t\t/>\n\t\t\t\t\t</Route>\n\t\t\t\t\t<Route exact path={Path.Cognates}>\n\t\t\t\t\t\t{cognates.length ? (\n\t\t\t\t\t\t\t<CognatesTab\n\t\t\t\t\t\t\t\t{...{\n\t\t\t\t\t\t\t\t\tcognates,\n\t\t\t\t\t\t\t\t\tlastSubmitted,\n\t\t\t\t\t\t\t\t\tword,\n\t\t\t\t\t\t\t\t\tquery,\n\t\t\t\t\t\t\t\t\terror,\n\t\t\t\t\t\t\t\t}}\n\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t) : null}\n\t\t\t\t\t</Route>\n\t\t\t\t\t<Route exact path={Path.Translations}>\n\t\t\t\t\t\t{translations.length ? (\n\t\t\t\t\t\t\t<TranslationsTab {...{ translations }} />\n\t\t\t\t\t\t) : null}\n\t\t\t\t\t</Route>\n\t\t\t\t</Switch>\n\t\t\t</article>\n\t\t</div>\n\t)\n}\n","import { FC } from 'react'\nimport { Link, useLocation } from 'react-router-dom'\nimport { Path } from '../Routes'\n\nconst LinkOrText: FC<{ isHome: boolean }> = ({ isHome, children }) => {\n\treturn isHome ? (\n\t\t<span className='search-header__text'>{children}</span>\n\t) : (\n\t\t<Link\n\t\t\tclassName='search-header__link search-header__text'\n\t\t\tto={Path.Home}\n\t\t>\n\t\t\t{children}\n\t\t</Link>\n\t)\n}\n\nexport const SearchHeader: FC<{}> = () => {\n\tconst location = useLocation()\n\tconst isHome = location.pathname === Path.Home\n\n\treturn (\n\t\t<header className='search-header y-margins'>\n\t\t\t<h1 className='search-header__main-heading'>\n\t\t\t\t<LinkOrText {...{ isHome }}>\n\t\t\t\t\t<img\n\t\t\t\t\t\tsrc='logo.svg'\n\t\t\t\t\t\talt=''\n\t\t\t\t\t\tclassName='search-header__logo'\n\t\t\t\t\t/>\n\t\t\t\t\t<span className='search-header__main-heading-text'>\n\t\t\t\t\t\tCognado\n\t\t\t\t\t</span>\n\t\t\t\t</LinkOrText>\n\t\t\t</h1>\n\t\t\t<div className='search-header__subheading'>\n\t\t\t\t<em>Cognate search</em>\n\t\t\t</div>\n\t\t</header>\n\t)\n}\n","import { pipe } from 'fp-ts/lib/function'\nimport { FC, Fragment, useState } from 'react'\nimport { Link } from 'react-router-dom'\nimport { makeCognateFinderUrl, toRelativeUrl } from '../utils/formatters'\nimport { getLangName, LangCode } from '../utils/langNames'\nimport { uniq } from '../utils/uniq'\n\ntype Example = {\n\tword: string\n\tsrcLang: LangCode\n\ttrgLang: LangCode\n}\n\nconst toExample =\n\t(srcLang: LangCode, trgLang: LangCode) =>\n\t(word: string): Example => ({ word, srcLang, trgLang })\n\nconst examples: Example[] = [\n\t['dedo', 'cuello', 'fuerte', 'hablar', 'puente', 'palabra'].map(\n\t\ttoExample('spa', 'eng'),\n\t),\n\t['demonstrate', 'hibernate', 'hospital'].map(toExample('eng', 'spa')),\n\t['moins', 'vie'].map(toExample('fra', 'eng')),\n\t['Brot', 'Nacht'].map(toExample('deu', 'eng')),\n].flat()\n\nconst getRandomExamples = (n: number) =>\n\tpipe(\n\t\texamples,\n\t\t(xs) => xs.sort(() => Math.random() - 0.5),\n\t\tuniq((x) => x.srcLang),\n\t\t(xs) => xs.slice(0, n),\n\t)\n\nexport const ExampleLinks: FC<{}> = () => {\n\tconst [examples] = useState(() => getRandomExamples(3))\n\n\treturn (\n\t\t<div className='example-links grayed-out'>\n\t\t\tOr try an example:{' '}\n\t\t\t{examples.map(({ word, srcLang, trgLang }, idx, arr) => (\n\t\t\t\t<Fragment key={idx}>\n\t\t\t\t\t<Link\n\t\t\t\t\t\tto={pipe(\n\t\t\t\t\t\t\tmakeCognateFinderUrl({\n\t\t\t\t\t\t\t\tword,\n\t\t\t\t\t\t\t\tsrcLang,\n\t\t\t\t\t\t\t\ttrgLang,\n\t\t\t\t\t\t\t}),\n\t\t\t\t\t\t\ttoRelativeUrl,\n\t\t\t\t\t\t)}\n\t\t\t\t\t>\n\t\t\t\t\t\t<em>{word}</em> ({getLangName(srcLang)})\n\t\t\t\t\t</Link>\n\t\t\t\t\t{idx === arr.length - 1 ? null : ', '}\n\t\t\t\t</Fragment>\n\t\t\t))}\n\t\t</div>\n\t)\n}\n","import {\n\tFC,\n\tuseEffect,\n\tuseState,\n\tuseMemo,\n\tuseCallback,\n\tuseContext,\n} from 'react'\nimport { useForm } from 'react-hook-form'\nimport {\n\tbuildSparqlQuery,\n\tCognateRaw,\n\tfetchCognates,\n\thydrate,\n\tisCognateError,\n} from '../core/cognates'\nimport { getLangName } from '../utils/langNames'\nimport { LangPair, ls } from '../utils/ls'\nimport { Spinner } from '../components/Spinner'\nimport { FormValues, getFormValues, qpInit } from '../utils/setupQps'\nimport { CognateSearchForm } from '../components/SearchForm'\nimport { Path, QpsContext } from '../Routes'\nimport { useHistory, useLocation } from 'react-router'\nimport { parseSeeAlsos } from '../core/seeAlsos'\nimport { parseTranslations } from '../core/translations'\nimport { fetchWiktionaryPageResult } from '../core/fetchWiktionaryPage'\nimport { createQps, pseudoHistory } from '../utils/qps'\nimport { Tabs } from '../components/Tabs'\nimport { getLangCodesFromSections } from '../core/parseMobileSections'\nimport clsx from 'clsx'\nimport { SearchHeader } from '../components/SearchHeader'\nimport { ExampleLinks } from '../components/ExampleLinks'\nimport { fetchWiktionaryDefinitionHtml } from '../core/getWikiContent'\n\ntype Props = {}\n\ntype Location_ = Window['location']\ntype Location = ReturnType<typeof useLocation>\n\nconst checkIsHome = (location: Location | Location_) =>\n\tlocation.pathname === Path.Home\n\nconst matches = (x: FormValues | null, y: FormValues | null) => {\n\tconst truthies = [x, y].filter(Boolean)\n\n\tswitch (truthies.length) {\n\t\tcase 0:\n\t\t\treturn true\n\t\tcase 1:\n\t\t\treturn false\n\t\tdefault:\n\t\t\treturn Object.entries(x!).every(\n\t\t\t\t([k, v]) => y![k as keyof FormValues] === v,\n\t\t\t)\n\t}\n}\n\nexport const SearchResults: FC<Props> = () => {\n\tconst location = useLocation()\n\tconst history = useHistory()\n\n\tconst qps = useContext(QpsContext)\n\n\tconst [seeAlsos, setSeeAlsos] = useState(ls.seeAlsos ?? [])\n\tconst [translations, setTranslations] = useState(ls.translations ?? [])\n\n\tconst defaultValues: FormValues = useMemo(() => getFormValues(qps), [qps])\n\n\tconst form = useForm<FormValues>({\n\t\tdefaultValues,\n\t})\n\n\tconst { watch, reset } = form\n\n\tconst allowAffixes = watch('allowAffixes')\n\tconst word = watch('word')\n\n\tconst [query, setQuery] = useState(\n\t\t() =>\n\t\t\tls.query ??\n\t\t\tbuildSparqlQuery({\n\t\t\t\t...getFormValues(qps),\n\t\t\t\tallowAffixes,\n\t\t\t}).sparql,\n\t)\n\n\tconst [error, setError] = useState<Error | null>(null)\n\tconst [loading, setLoading] = useState<boolean>(false)\n\n\tconst [cognates, setCognates] = useState<CognateRaw[]>(ls.cognates ?? [])\n\n\tconst [lastSubmitted, setLastSubmitted] = useState<FormValues | null>(\n\t\tls.lastSubmitted ?? null,\n\t)\n\n\tuseEffect(() => {\n\t\tif (!qps.get('word')) {\n\t\t\tsetLastSubmitted(null)\n\t\t}\n\t}, [qps])\n\n\tuseEffect(() => {\n\t\tif (!lastSubmitted) {\n\t\t\tsetSeeAlsos([])\n\t\t}\n\t}, [lastSubmitted])\n\n\tconst [definition, setDefinition] = useState(ls.definition ?? '')\n\n\tconst [suggestedLangPairs, setSuggestedLangPairs] = useState<LangPair[]>([])\n\n\tuseEffect(() => {\n\t\tlet canceled = false\n\n\t\tif (canceled) {\n\t\t\treturn\n\t\t}\n\n\t\tconst values = getFormValues(qps)\n\n\t\tif (matches(lastSubmitted, values)) {\n\t\t\treturn\n\t\t}\n\n\t\tconst { word, srcLang, trgLang, allowAffixes } = values\n\n\t\tif (!word) {\n\t\t\treturn\n\t\t}\n\n\t\tsetLoading(true)\n\n\t\tPromise.all([\n\t\t\tfetchCognates(word.trim(), srcLang, trgLang, allowAffixes),\n\t\t\tfetchWiktionaryPageResult(word.trim()),\n\t\t\tfetchWiktionaryDefinitionHtml(word, srcLang),\n\t\t])\n\t\t\t.then(([result, wiktionaryResult, definition]) => {\n\t\t\t\tconst { wiktionaryText, seeAlsos } =\n\t\t\t\t\twiktionaryResult.kind === 'error'\n\t\t\t\t\t\t? {\n\t\t\t\t\t\t\t\twiktionaryText: '',\n\t\t\t\t\t\t\t\tseeAlsos:\n\t\t\t\t\t\t\t\t\twiktionaryResult.prefetchedVariants.flatMap(\n\t\t\t\t\t\t\t\t\t\t(x) => [\n\t\t\t\t\t\t\t\t\t\t\tx.word,\n\t\t\t\t\t\t\t\t\t\t\t...parseSeeAlsos(x.data),\n\t\t\t\t\t\t\t\t\t\t],\n\t\t\t\t\t\t\t\t\t),\n\t\t\t\t\t\t  }\n\t\t\t\t\t\t: {\n\t\t\t\t\t\t\t\twiktionaryText: wiktionaryResult.data,\n\t\t\t\t\t\t\t\tseeAlsos: parseSeeAlsos(wiktionaryResult.data),\n\t\t\t\t\t\t  }\n\n\t\t\t\tconst translations = parseTranslations(wiktionaryText)\n\n\t\t\t\tconst langCodesFromSections =\n\t\t\t\t\tgetLangCodesFromSections(wiktionaryText)\n\n\t\t\t\tconst suggestTryFlipped =\n\t\t\t\t\t!langCodesFromSections.includes(srcLang) &&\n\t\t\t\t\tlangCodesFromSections.includes(trgLang)\n\n\t\t\t\tconst suggestedLangPairs: LangPair[] = suggestTryFlipped\n\t\t\t\t\t? [{ srcLang: trgLang, trgLang: srcLang }]\n\t\t\t\t\t: langCodesFromSections.map((srcLang) => ({\n\t\t\t\t\t\t\tsrcLang,\n\t\t\t\t\t\t\ttrgLang,\n\t\t\t\t\t  }))\n\n\t\t\t\tsetLoading(false)\n\n\t\t\t\tif (isCognateError(result)) {\n\t\t\t\t\tsetError(new Error(result.error))\n\t\t\t\t} else {\n\t\t\t\t\tconst { cognates, query } = result\n\n\t\t\t\t\tsetError(null)\n\t\t\t\t\tsetLastSubmitted(values)\n\t\t\t\t\tsetCognates(cognates)\n\t\t\t\t\tsetSeeAlsos(seeAlsos)\n\t\t\t\t\tsetTranslations(translations)\n\t\t\t\t\tsetSuggestedLangPairs(suggestedLangPairs)\n\t\t\t\t\tsetDefinition(definition)\n\n\t\t\t\t\tsetQuery(query)\n\n\t\t\t\t\tls.lastSubmitted = values\n\t\t\t\t\tls.cognates = cognates\n\t\t\t\t\tls.query = query\n\t\t\t\t\tls.seeAlsos = seeAlsos\n\t\t\t\t\tls.translations = translations\n\t\t\t\t\tls.suggestedLangPairs = suggestedLangPairs\n\t\t\t\t\tls.definition = definition\n\n\t\t\t\t\treset(values)\n\t\t\t\t}\n\t\t\t})\n\t\t\t.catch((e) => {\n\t\t\t\tsetError(e)\n\t\t\t\tsetLoading(false)\n\t\t\t})\n\n\t\treturn () => {\n\t\t\tcanceled = true\n\t\t}\n\t}, [location, lastSubmitted, qps, reset])\n\n\tconst onSubmit = useCallback(\n\t\tasync (values: FormValues) => {\n\t\t\tconst u = new URL(window.location.href)\n\n\t\t\tconst pseudoQps = createQps(qpInit, pseudoHistory(u))\n\n\t\t\tpseudoQps.setMany({ ...values, page: 1 })\n\n\t\t\thistory.push({ pathname: Path.Definition, search: u.search })\n\n\t\t\tsetLastSubmitted(values.word ? values : null)\n\t\t},\n\t\t[history],\n\t)\n\n\tconst hydrated = useMemo(() => hydrate(cognates), [cognates])\n\n\tconst relevantTranslations = useMemo(\n\t\t() =>\n\t\t\tlastSubmitted?.trgLang\n\t\t\t\t? translations\n\t\t\t\t\t\t.map(({ meaning, translations }) => ({\n\t\t\t\t\t\t\tmeaning,\n\t\t\t\t\t\t\ttranslations:\n\t\t\t\t\t\t\t\ttranslations[\n\t\t\t\t\t\t\t\t\tgetLangName(lastSubmitted.trgLang ?? '') ??\n\t\t\t\t\t\t\t\t\t\t''\n\t\t\t\t\t\t\t\t],\n\t\t\t\t\t\t\ttrgLang: lastSubmitted.trgLang,\n\t\t\t\t\t\t}))\n\t\t\t\t\t\t.filter((x) => x.translations)\n\t\t\t\t: [],\n\t\t[translations, lastSubmitted?.trgLang],\n\t)\n\n\tconst isHome = checkIsHome(location)\n\n\treturn (\n\t\t<div\n\t\t\tclassName={clsx([\n\t\t\t\t'search-results__ancestor',\n\t\t\t\tisHome && 'search-results__ancestor--home-page',\n\t\t\t])}\n\t\t>\n\t\t\t<div\n\t\t\t\tclassName={clsx([\n\t\t\t\t\t'search-results__outer',\n\t\t\t\t\tisHome && 'search-results__outer--home-page',\n\t\t\t\t])}\n\t\t\t>\n\t\t\t\t<SearchHeader />\n\n\t\t\t\t<CognateSearchForm\n\t\t\t\t\t{...{\n\t\t\t\t\t\tform,\n\t\t\t\t\t\tonSubmit,\n\t\t\t\t\t\tseeAlsos: isHome ? [] : seeAlsos,\n\t\t\t\t\t}}\n\t\t\t\t/>\n\n\t\t\t\t{isHome ? (\n\t\t\t\t\t<ExampleLinks />\n\t\t\t\t) : loading ? (\n\t\t\t\t\t<Spinner />\n\t\t\t\t) : !lastSubmitted ? (\n\t\t\t\t\t<div className='y-margins grayed-out'>\n\t\t\t\t\t\tEnter a word to search for\n\t\t\t\t\t</div>\n\t\t\t\t) : (\n\t\t\t\t\t<Tabs\n\t\t\t\t\t\t{...{\n\t\t\t\t\t\t\tdefinition,\n\t\t\t\t\t\t\tword,\n\t\t\t\t\t\t\tlastSubmitted,\n\t\t\t\t\t\t\ttranslations: relevantTranslations,\n\t\t\t\t\t\t\tcognates: hydrated,\n\t\t\t\t\t\t\tquery,\n\t\t\t\t\t\t\terror,\n\t\t\t\t\t\t\tsuggestedLangPairs,\n\t\t\t\t\t\t}}\n\t\t\t\t\t/>\n\t\t\t\t)}\n\t\t\t</div>\n\t\t</div>\n\t)\n}\n","import { LangCode, langNamesToCodes } from '../utils/langNames'\n\nexport const getLangCodesFromSections = (text: string) =>\n\ttext\n\t\t.split(/\\r\\n|[\\r\\n]/)\n\t\t.map((x) => x.trim().match(/^==(.+)==$/)?.[1])\n\t\t.map((x) => x && langNamesToCodes[x as keyof typeof langNamesToCodes])\n\t\t.filter(Boolean) as LangCode[]\n","import { FC, useContext, useEffect } from 'react'\nimport { useHistory } from 'react-router-dom'\nimport { Path, QpsContext } from '../Routes'\n\nexport const ShareTarget: FC = () => {\n\tconst history = useHistory()\n\n\tconst qps = useContext(QpsContext)\n\n\tuseEffect(() => {\n\t\tconst shareText = qps.get('shareText')\n\n\t\tconst content = shareText?.match(/^\"([\\s\\S]+)\"\\n\\s*https?:\\/\\/.+$/)?.[1]\n\n\t\tqps.delete('shareText', false)\n\t\tqps.set('word', content ?? shareText ?? '', false)\n\n\t\thistory.replace({\n\t\t\tpathname: Path.Definition,\n\t\t\tsearch: window.location.search,\n\t\t})\n\t}, [history, qps])\n\n\treturn null\n}\n","import { forwardRef, HTMLProps, SVGProps } from 'react'\nimport './GitHubCorner.css'\n\n// modified from https://github.com/skratchdot/react-github-corner\n\ntype Props = HTMLProps<HTMLAnchorElement> & {\n\thref: string\n\trtl?: boolean\n\tsvgProps?: SVGProps<SVGElement>\n\toctoBannerProps?: SVGProps<SVGPathElement>\n\toctoArmProps?: SVGProps<SVGPathElement>\n\toctoBodyProps?: SVGProps<SVGPathElement>\n}\n\nexport const GitHubCorner = forwardRef<HTMLAnchorElement, Props>(\n\t(\n\t\t{\n\t\t\toctoBannerProps,\n\t\t\toctoArmProps,\n\t\t\toctoBodyProps,\n\t\t\ttitle,\n\t\t\trtl,\n\t\t\t...linkProps\n\t\t},\n\t\tref,\n\t) => {\n\t\tconst rtlStyles = rtl\n\t\t\t? {\n\t\t\t\t\tright: undefined,\n\t\t\t\t\tleft: 0,\n\t\t\t\t\ttransform: 'scaleX(-1)',\n\t\t\t  }\n\t\t\t: {}\n\n\t\treturn (\n\t\t\t<div>\n\t\t\t\t<svg\n\t\t\t\t\tclassName='gh-corner'\n\t\t\t\t\twidth='80'\n\t\t\t\t\theight='80'\n\t\t\t\t\tviewBox='0 0 250 250'\n\t\t\t\t\tstyle={rtlStyles}\n\t\t\t\t>\n\t\t\t\t\t<a ref={ref} {...linkProps} className='gh-corner__link'>\n\t\t\t\t\t\t<title>{title}</title>\n\n\t\t\t\t\t\t<path\n\t\t\t\t\t\t\tclassName='gh-corner__click-target-transparent'\n\t\t\t\t\t\t\td='M 0 0 L 250 250 V 0 Z'\n\t\t\t\t\t\t></path>\n\n\t\t\t\t\t\t<path\n\t\t\t\t\t\t\tclassName='gh-corner__octo-banner'\n\t\t\t\t\t\t\td='M0 0l115 115h15l12 27 108 108V0z'\n\t\t\t\t\t\t\t{...octoBannerProps}\n\t\t\t\t\t\t></path>\n\n\t\t\t\t\t\t<path\n\t\t\t\t\t\t\tclassName='gh-corner__octo-arm'\n\t\t\t\t\t\t\td='M128 109c-15-9-9-19-9-19 3-7 2-11 2-11-1-7 3-2 3-2 4 5 2 11 2 11-3 10 5 15 9 16'\n\t\t\t\t\t\t\t{...octoArmProps}\n\t\t\t\t\t\t></path>\n\t\t\t\t\t\t<path\n\t\t\t\t\t\t\tclassName='gh-corner__octo-body'\n\t\t\t\t\t\t\td='M115 115s4 2 5 0l14-14c3-2 6-3 8-3-8-11-15-24 2-41 5-5 10-7 16-7 1-2 3-7 12-11 0 0 5 3 7 16 4 2 8 5 12 9s7 8 9 12c14 3 17 7 17 7-4 8-9 11-11 11 0 6-2 11-7 16-16 16-30 10-41 2 0 3-1 7-5 11l-12 11c-1 1 1 5 1 5z'\n\t\t\t\t\t\t\t{...octoBodyProps}\n\t\t\t\t\t\t></path>\n\t\t\t\t\t</a>\n\t\t\t\t</svg>\n\t\t\t</div>\n\t\t)\n\t},\n)\n","import { Component } from 'react'\n\ntype Props = {}\ntype State = {\n\thasError: boolean\n}\n\nexport class RootErrorBoundary extends Component<{}, State> {\n\tconstructor(props: Props) {\n\t\tsuper(props)\n\n\t\tthis.state = { hasError: false }\n\t}\n\n\tstatic getDerivedStateFromError(e: any) {\n\t\tconsole.error(e)\n\n\t\treturn { hasError: true }\n\t}\n\n\tcomponentDidCatch(e: any, errorInfo: any) {\n\t\tconsole.error(e, errorInfo)\n\t}\n\n\trender() {\n\t\tif (this.state.hasError) {\n\t\t\treturn (\n\t\t\t\t<>\n\t\t\t\t\t<h1>Something went wrong.</h1>\n\t\t\t\t\t<p>\n\t\t\t\t\t\t<a\n\t\t\t\t\t\t\thref={process.env.PUBLIC_URL}\n\t\t\t\t\t\t\tonClick={() => localStorage.clear()}\n\t\t\t\t\t\t>\n\t\t\t\t\t\t\tBack to home page\n\t\t\t\t\t\t</a>\n\t\t\t\t\t</p>\n\t\t\t\t</>\n\t\t\t)\n\t\t}\n\n\t\treturn this.props.children\n\t}\n}\n","import { BrowserRouter as Router } from 'react-router-dom'\nimport { Footer } from './components/Footer'\nimport { Routes } from './Routes'\nimport { GitHubCorner } from './components/GitHubCorner'\nimport { urls } from './config'\nimport { RootErrorBoundary } from './components/RootErrorBoundary'\nimport { Tooltip } from './components/Tooltip'\n\nexport const App = () => {\n\treturn (\n\t\t<RootErrorBoundary>\n\t\t\t<Router basename={process.env.PUBLIC_URL}>\n\t\t\t\t<div className='full-page'>\n\t\t\t\t\t<Tooltip\n\t\t\t\t\t\ttitle='View project on GitHub'\n\t\t\t\t\t\tenterTouchDelay={300}\n\t\t\t\t\t>\n\t\t\t\t\t\t<GitHubCorner\n\t\t\t\t\t\t\ttarget='_blank'\n\t\t\t\t\t\t\trel='noreferrer noopener'\n\t\t\t\t\t\t\thref={urls.github}\n\t\t\t\t\t\t/>\n\t\t\t\t\t</Tooltip>\n\t\t\t\t\t<main className='container'>\n\t\t\t\t\t\t<Routes />\n\t\t\t\t\t</main>\n\t\t\t\t\t<Footer className='container' />\n\t\t\t\t</div>\n\t\t\t</Router>\n\t\t</RootErrorBoundary>\n\t)\n}\n","import { isSameOrigin } from './browser'\n\nconst cssConstants: Record<string, string | undefined> = {\n\t...process.env,\n\tROOT_URL: window.location.origin + process.env.PUBLIC_URL,\n}\n\nconst matcher = /%(\\w+)%/g\n\nexport const injectCssConstants = () => {\n\tfor (const rule of [...document.styleSheets]\n\t\t// local stylesheets only\n\t\t.filter((sheet) => !sheet.href || isSameOrigin(sheet.href))\n\t\t.flatMap((sheet) => [...sheet.cssRules])\n\t\t.filter((rule): rule is CSSStyleRule => rule instanceof CSSStyleRule)\n\t\t.filter((rule) => matcher.test(rule.selectorText))) {\n\t\trule.selectorText = rule.selectorText.replace(\n\t\t\tmatcher,\n\t\t\t(m, name) => cssConstants[name] ?? m,\n\t\t)\n\t}\n}\n","// This optional code is used to register a service worker.\n// register() is not called by default.\n\n// This lets the app load faster on subsequent visits in production, and gives\n// it offline capabilities. However, it also means that developers (and users)\n// will only see deployed updates on subsequent visits to a page, after all the\n// existing tabs open on the page have been closed, since previously cached\n// resources are updated in the background.\n\n// To learn more about the benefits of this model and instructions on how to\n// opt-in, read https://cra.link/PWA\n\nconst isLocalhost = Boolean(\n\twindow.location.hostname === 'localhost' ||\n\t\t// [::1] is the IPv6 localhost address.\n\t\twindow.location.hostname === '[::1]' ||\n\t\t// 127.0.0.0/8 are considered localhost for IPv4.\n\t\twindow.location.hostname.match(\n\t\t\t/^127(?:\\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/,\n\t\t),\n)\n\ntype Config = {\n\tonSuccess?: (registration: ServiceWorkerRegistration) => void\n\tonUpdate?: (registration: ServiceWorkerRegistration) => void\n}\n\nexport function register(config?: Config) {\n\tif (process.env.NODE_ENV === 'production' && 'serviceWorker' in navigator) {\n\t\t// The URL constructor is available in all browsers that support SW.\n\t\tconst publicUrl = new URL(process.env.PUBLIC_URL, window.location.href)\n\t\tif (publicUrl.origin !== window.location.origin) {\n\t\t\t// Our service worker won't work if PUBLIC_URL is on a different origin\n\t\t\t// from what our page is served on. This might happen if a CDN is used to\n\t\t\t// serve assets; see https://github.com/facebook/create-react-app/issues/2374\n\t\t\treturn\n\t\t}\n\n\t\twindow.addEventListener('load', () => {\n\t\t\tconst swUrl = `${process.env.PUBLIC_URL}/service-worker.js`\n\n\t\t\tif (isLocalhost) {\n\t\t\t\t// This is running on localhost. Let's check if a service worker still exists or not.\n\t\t\t\tcheckValidServiceWorker(swUrl, config)\n\n\t\t\t\t// Add some additional logging to localhost, pointing developers to the\n\t\t\t\t// service worker/PWA documentation.\n\t\t\t\tnavigator.serviceWorker.ready.then(() => {\n\t\t\t\t\tconsole.info(\n\t\t\t\t\t\t'This web app is being served cache-first by a service ' +\n\t\t\t\t\t\t\t'worker. To learn more, visit https://cra.link/PWA',\n\t\t\t\t\t)\n\t\t\t\t})\n\t\t\t} else {\n\t\t\t\t// Is not localhost. Just register service worker\n\t\t\t\tregisterValidSW(swUrl, config)\n\t\t\t}\n\t\t})\n\t}\n}\n\nfunction registerValidSW(swUrl: string, config?: Config) {\n\tnavigator.serviceWorker\n\t\t.register(swUrl)\n\t\t.then((registration) => {\n\t\t\tregistration.onupdatefound = () => {\n\t\t\t\tconst installingWorker = registration.installing\n\t\t\t\tif (installingWorker == null) {\n\t\t\t\t\treturn\n\t\t\t\t}\n\t\t\t\tinstallingWorker.onstatechange = () => {\n\t\t\t\t\tif (installingWorker.state === 'installed') {\n\t\t\t\t\t\tif (navigator.serviceWorker.controller) {\n\t\t\t\t\t\t\t// At this point, the updated precached content has been fetched,\n\t\t\t\t\t\t\t// but the previous service worker will still serve the older\n\t\t\t\t\t\t\t// content until all client tabs are closed.\n\t\t\t\t\t\t\tconsole.info(\n\t\t\t\t\t\t\t\t'New content is available and will be used when all ' +\n\t\t\t\t\t\t\t\t\t'tabs for this page are closed. See https://cra.link/PWA.',\n\t\t\t\t\t\t\t)\n\n\t\t\t\t\t\t\t// Execute callback\n\t\t\t\t\t\t\tif (config && config.onUpdate) {\n\t\t\t\t\t\t\t\tconfig.onUpdate(registration)\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t// At this point, everything has been precached.\n\t\t\t\t\t\t\t// It's the perfect time to display a\n\t\t\t\t\t\t\t// \"Content is cached for offline use.\" message.\n\t\t\t\t\t\t\tconsole.info('Content is cached for offline use.')\n\n\t\t\t\t\t\t\t// Execute callback\n\t\t\t\t\t\t\tif (config && config.onSuccess) {\n\t\t\t\t\t\t\t\tconfig.onSuccess(registration)\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t})\n\t\t.catch((error) => {\n\t\t\tconsole.error('Error during service worker registration:', error)\n\t\t})\n}\n\nfunction checkValidServiceWorker(swUrl: string, config?: Config) {\n\t// Check if the service worker can be found. If it can't reload the page.\n\tfetch(swUrl, {\n\t\theaders: { 'Service-Worker': 'script' },\n\t})\n\t\t.then((response) => {\n\t\t\t// Ensure service worker exists, and that we really are getting a JS file.\n\t\t\tconst contentType = response.headers.get('content-type')\n\t\t\tif (\n\t\t\t\tresponse.status === 404 ||\n\t\t\t\t(contentType != null &&\n\t\t\t\t\tcontentType.indexOf('javascript') === -1)\n\t\t\t) {\n\t\t\t\t// No service worker found. Probably a different app. Reload the page.\n\t\t\t\tnavigator.serviceWorker.ready.then((registration) => {\n\t\t\t\t\tregistration.unregister().then(() => {\n\t\t\t\t\t\twindow.location.reload()\n\t\t\t\t\t})\n\t\t\t\t})\n\t\t\t} else {\n\t\t\t\t// Service worker found. Proceed as normal.\n\t\t\t\tregisterValidSW(swUrl, config)\n\t\t\t}\n\t\t})\n\t\t.catch(() => {\n\t\t\tconsole.info(\n\t\t\t\t'No internet connection found. App is running in offline mode.',\n\t\t\t)\n\t\t})\n}\n\nexport function unregister() {\n\tif ('serviceWorker' in navigator) {\n\t\tnavigator.serviceWorker.ready\n\t\t\t.then((registration) => {\n\t\t\t\tregistration.unregister()\n\t\t\t})\n\t\t\t.catch((error) => {\n\t\t\t\tconsole.error(error.message)\n\t\t\t})\n\t}\n}\n","const setVh = () => {\n\tconst vh = window.innerHeight * 0.01\n\tdocument.documentElement.style.setProperty('--vh', `${vh}px`)\n}\n\nexport const initViewportHeightAdjuster = () => {\n\twindow.addEventListener('resize', setVh)\n\n\tsetVh()\n}\n","/* can't use `chota.min.css` due to CRA transpiling bug */\nimport './vendor/chota.100.css'\n/* import `styles.css` after `chota.css`to override definedvars */\nimport './styles.css'\nimport { render } from 'react-dom'\nimport { App } from './App'\nimport { exposeGlobals } from './debug'\nimport buildInfo from './buildInfo.json'\n\nimport { injectCssConstants } from './utils/dynamicStyles'\nimport * as serviceWorkerRegistration from './serviceWorkerRegistration'\nimport { initViewportHeightAdjuster } from './utils/viewportHeightAdjuster'\nimport { addGlobalListeners } from './utils/addGlobalListeners'\n\n/* import `overrides.css` last to give precedence over component styles */\nimport './overrides.css'\n\nexposeGlobals()\ninjectCssConstants()\ninitViewportHeightAdjuster()\naddGlobalListeners()\n\nrender(<App />, document.getElementById('root'))\n\n// If you want your app to work offline and load faster, you can change\n// unregister() to register() below. Note this comes with some pitfalls.\n// Learn more about service workers: https://cra.link/PWA\nserviceWorkerRegistration.register()\n\nconsole.info(`Build ${buildInfo.hash}\\n${buildInfo.ts}`)\n","export const addGlobalListeners = () => {\n\t// always scroll to top when internal link clicked to avoid jank\n\tdocument.body.addEventListener('click', (e) => {\n\t\tif (\n\t\t\te.target instanceof HTMLAnchorElement &&\n\t\t\te.target.href &&\n\t\t\t!e.target.target\n\t\t) {\n\t\t\twindow.scrollTo(0, 0)\n\t\t}\n\t})\n}\n"],"sourceRoot":""}